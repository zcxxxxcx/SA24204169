<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zhang chunxu" />

<meta name="date" content="2024-12-07" />

<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Zhang chunxu</h4>
<h4 class="date">2024-12-07</h4>



<div id="hw0" class="section level1">
<h1>HW0</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples.For each example,texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
<div id="example-1" class="section level3">
<h3>Example 1</h3>
<p>graphing functions <span class="math display">\[y=x^2\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>GF <span class="ot">&lt;-</span> <span class="cf">function</span>(f,a,b){</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(<span class="dv">1000</span> ,<span class="at">min =</span> a,<span class="at">max =</span> b))</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">f</span>(x)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="fu">plot</span>(x,y,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">GF</span>(f1 ,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2" class="section level3">
<h3>Example 2</h3>
<p>matrix multiplication</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>A<span class="sc">%*%</span>B</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    3    1
## [2,]    4    2</code></pre>
</div>
<div id="example-3" class="section level3">
<h3>Example 3</h3>
<p>calculating <span class="math inline">\(\pi\)</span> using
montecarlo</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>z <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;pi =&quot;</span>,<span class="fu">sum</span>(z<span class="sc">&lt;</span><span class="dv">1</span>)<span class="sc">/</span>N<span class="sc">*</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## pi = 3.148</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">col=</span><span class="fu">ifelse</span>((z) <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>),<span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>lx <span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>,<span class="at">length=</span>N)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">lines</span>(lx ,<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>lx<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="exercise-3.4" class="section level2">
<h2>Exercise 3.4</h2>
<p>Develop an algorithm to generate random samples from a Rayleigh(σ)
distribution. Generate Rayleigh(σ) samples for several choices of σ &gt;
0 and check that the mode of the generated samples is close to the
theoretical mode σ (check the histogram).</p>
<p><span class="math display">\[
使用逆变换法：\\
f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},x\geq0,\sigma&gt;0\\
F(x)=1-e^{-x^2/(2\sigma^2)}\\
F^{-1}(x)=\sqrt{-2\sigma^2\ln(1-x)}
\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>rRayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n,sigma)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>{</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>x))</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>}</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rRayleigh</span>(<span class="dv">1000</span>,<span class="dv">1</span>),<span class="at">main =</span> <span class="st">&quot;σ=1&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rRayleigh</span>(<span class="dv">1000</span>,<span class="dv">2</span>),<span class="at">main =</span> <span class="st">&quot;σ=2&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rRayleigh</span>(<span class="dv">1000</span>,<span class="dv">3</span>),<span class="at">main =</span> <span class="st">&quot;σ=3&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rRayleigh</span>(<span class="dv">1000</span>,<span class="dv">4</span>),<span class="at">main =</span> <span class="st">&quot;σ=4&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.11" class="section level2">
<h2>Exercise 3.11</h2>
<p>Generate a random sample of size 1000 from a normal location mixture.
The components of the mixture have N (0, 1) and N (3, 1) distributions
with mixing probabilities p1 and p2 = 1 − p1. Graph the histogram of the
sample with density superimposed, for p1 = 0.75. Repeat with different
values for p1 and observe whether the empirical distribution of the
mixture appears to be bimodal. Make a conjecture about the values of p1
that produce bimodal mixtures.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="cf">function</span>(p){</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>x1 <span class="sc">+</span> (k)<span class="sc">*</span>x2</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">hist</span>(x, </span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>       <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">bquote</span>(<span class="st">&#39;p=&#39;</span><span class="sc">*</span>.(p))</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>       )</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(x), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>}</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="fu">fun</span>(<span class="fl">0.75</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">fun</span>(<span class="fl">0.1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">fun</span>(<span class="fl">0.3</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAilBMVEUAAAAAACsAAFUAK1UAK4AAVaorAAArACsrKwArKysrK1UrVYArVaorgNRVAABVACtVKwBVVQBVVVVVgKpVqv+AKwCAVQCAVSuAqtSA1P+qVQCqVSuqgCuqgFWq1P+q/6qq/9Sq///T09PUgCvU1IDU/9TU////AAD/qlX/1ID/1Kr//6r//9T///9BC6D4AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJWElEQVR4nO2da3ubNhiG5SzJjna7rd4Wd8ta2IKzmP//9wYCbLCRHkCvDnae+0NTN0Uy9yWETq+kSmJFxf4CqUNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBLgCQYe/HtXq15fT59/V4LNfrkDQTtU8dB/fPg4/eyZ9QXv1zXP530f1qf2cq59eqs+rpzDZpy9op1W8PrZF5rC9r5+u/CjMMykJ2t19+azUD8/VY7RRDXdfWyHtj45/Nndfw3yptAT9XEupSkxP0Nvmof3lyUiu1P1zoC+VlCC1+qM8fB7Wv2OCdt9XhgK9xpISpGubw3bw9IwJKutCFOg1lpSgxkG+egKPWHmh0R/JCxqvpC+EeSMpQWOP2Plr/m2jTb2Feo0lJahuEp5X0hcNxZ1uKG7VOsyXSkrQ6rvmsTr752PXIq8LU/v4vcu32N2Xqh/64/mdH/7sOqt58wy+285qqHp3FhQEoCAABQFSEpQkFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIcJ2CipowWV2joKIlSGbXKUj/QUEGWjWBDF2RoHbxvSoK/SOQoWsSlGkqL/UPCrrgKChrBIUxdHWCipOgkoIGqH4BagX5N3S9gpr6umhrbn+5ektZHNV/wrKzT/5y9ZayOKpfgLLLGslTrt5SFoeCAKr/TGXnrSJvuXpLWRzVL0AUdMmooNYQBZVaUEFBFlS/AB0FZRTUYRRUUJBG9Z+wk6DsGgSpIyLJGTLpF6CBoCJ5Qb6SG6ZNQSDtYlxQRkFt2n0/FDSStklQZYiCSgqCFBRkZ+DnTJC/odc5d/S2WZf1fj6XO9gsSm4uZkFZSoLyeuOet41hm0ePgorIgt42cF+5WlCrJjfsb+RVUBZVkN6+0b7vVS3o9VEL2hseskiCPBoa3pHdUdQSVCQhqFFkqoKb3cMeyq66npCcHNWrPL6g+gX16XLLwh6Vo9VT9f/WU5KTpIgvqC4fjRlTBTMrOWEqA3ZBvgz13mISW1jHEqQCCPrQ+HEoPqU/QUU6gvJEBZVxBe1Og6Zr4/89bkFrftN5ElREF3QqQTbwHsXeBJVAkLfFVPPu6LAF3RE/goqrEVS1gEZ7qZ5nNZqbjymoahn39rh2Tk6YIr6gVJPTdI1AJMiPoasQ1KZtFeSrCPW7Gmt9YMWkjZpNrSUPgopUBO3uX+qN43dOxzHIChouZI0sqB7oqd9RKXU1xlcERRRU71ecUlfDtJ7DIMiLod4j9lCfyNCd8zHOYQuaAqKCdNScUcm5IE9FaDAetHqyN5XzrqNmHDGTEtQFFVqUBBeEOWzX3V/9jkl3IZdWJQkK6s2G+ZzVKKa92IMLgvVLgBKk3+qn9/o8QX4M9Spp/Po6npvnpw66qHeSEmScyenT9WiNzW0HQZe1cmqCJE5VXCyoGBk0TEsQHAubl9zkC7pI5uKy0klLkGksbGlyUy/Q93eManIS5MVQf3VHjAGzkTDCRAVFSm4sSo6C+hf0C1DigqqH7P5lt5ZKbuIF2VgQ2GJB8oZ6lfTqKa978+slqSye1bAN+cwW5KMI9V7za92BCDweZIhxSlBQ3VCsBQUeUbSNic0RNNgYRrJivShBO6fjJxcJMt31HEHNDw9B4ud1kOM57vMFWXqn8wVl8jHQw7eYPstcKLmJFxjjC9ITFCU5CgKYI1QWCpKOgT7ri7keELxAkPmuFwiSDxLv0to1lXPueMb0zQrad5VzG2rgmNxkrDM7CQnqjZaFnZu3jrEuEyQcRX9cQNX9Q9Cuhn0Qeokg8W0GOkFwxmtOcpOxxxdQkB9BskHiUQWBCJVFgqSj6CMLss4uJyUIrqGfk9xE0PqEpYJEg8RjdjVQfMEyQcJR9DcpSHJcMaIgGKFCQaUXQbLxmTKClsxq4AiV5YIEDcUrQTgAY6kg0SJ0o4LkDEUTNCGEZ7EgyfjDiIKaCzwJEjMUS9CUGKflggRn6eMJai+4LUESoQiDJXfWlb4OguQMzRIkEoqg78WwIujKBcksJFeZecmUnCAxQ+FDEdTkIDAnQVKGopSgiUFgywWdhSrOuMcld3RCJBRhepTcckH6T5lDN+ZdLBGKYFvwIipI5kyJ8O0g23IFWUEiRyYEFzQjjFBCkPNMdOCG4qyAHmdBWRNAFLKSXjd/WVRJt+Fg0+/TXVCjKJggh9d8F6Rb2ntf8oKyY74L8d5QLE7MjbMUEdQpWmrJRwkqLll0Z0KCMjXyhSbbkmkoDgbtz76JSoUAgnBD8fYQbgfdHhQEWCjIbaHeNeGlBMWtjC9xuhcpKZMTtf0y/IUQCgIId1YnJHrLgnBndUKiNyxoQldjQqI3LGjyWtj3KoglCIFnNSYkesuCpnZW36+gdwgFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC+BJk3ApND2uvx36zt+x/Zb4KZFe+Pip4wq4NT4L2phGRw7aSkI995XoDmr3BkPkqkF25r35hP+kB4EeQ3tRz9DfN9jsjE7PNcKVh7xnjVSi7JlWXeWA/gvL736xjaiMlBTgwXIWye/3W9ehPL4Kqr2XfjnFk//zmVqyTAaZd9y3Z7e/+3oATrAE+BNXl2ipobEi7KR7GQmK4CmWX13OcTput+xCENvTcm+poq6DRq1B2+QqWS4AHQfphsQgaLwnoETNOpFiza+o0l43ZZAXp49jzdtHJ+Zdqz2o3bLQHKmnz9nym7DSNcJeqOnhD0bRZrPU1b7wKZddMBif2iGlM3/j1cW24wtZQNF8FstMVVG9GeD6hBbUPxJiI3NzVsFxlz053YJJ7zd8UFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA1AXVS856R1SGJ3VB3Snv0UhdUL3S+YPrYnAXkhdU7pxiUZxJX9AerN/0TPKCDttfom5JmLyg/P5fl0WqzqQuqF7o7Hb0qyOpC9rpdc4Rq+nUBUWHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A+MkcBcI3OWJQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">fun</span>(<span class="fl">0.5</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">fun</span>(<span class="fl">0.7</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">fun</span>(<span class="fl">0.9</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAllBMVEUAAAAAACsAAFUAKysAK1UAK4AAVaorAAArACsrKwArK1UrK4ArVYArVaorgNRVAABVACtVKwBVKytVVQBVVVVVgKpVqtRVqv+AKwCAVQCAVSuAqtSA1P+qVQCqVSuqgCuqgFWq1P+q/6qq/9Sq///T09PUgCvUqoDU1P/U/9TU////AAD/qlX/1ID/1Kr//6r//9T////sDa4oAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJkElEQVR4nO3da3ubNgAFYJzNTbtL0l2bbXG3rIVtkd2Y///nhhA4GBsdCV2xz/lQz4sN5n2EAF2gqBltitQ/IPcQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAWALT/67ZY/fL8+v73olj9GmvtCwDaFDJv+rcv98fvAyd/oG3x9VP95YfiQ/d+U6yf6v3Hw/vAyR9os3ps/t3ddkXm5X4t97b9Q6QilBPQ5ubTx6L45umwGxXFzef9QweyVrXQy72S2ayfNYvyl7yAfpIoTYkZAB1Abj63r4cS1L0PnayAitUfsnY52nnGQM2nvn+Wn7pGoLa2GZWNE6DdbVvM3l0jkNrmavWo2cXq+suPsqLaEOh8Jd1l/D5YsgI6t4uND/Md47a4i/OjsgKSp4TjSvrkRLEq3jzX/9y2bBGSFdDqndqtRv/7cGlRSZVu94tUgPICuvnUXId+N65b9n/2F6uV2gebD311lRersQ5MViEQCIFACASSE1CWIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQO6D9Qz/oItDPyS9WQFXfIx5tbEX62ADtHw4sVaTROeljA/RyfxibvL2anYwlCMSyDuqKEOugifRjB6+m/PA8CCYrICH6V5H2hwwyA2jbzhYIkYNLRkJ2QJuiuNt9+zw84HuMWDyQnGGjhi0HOcwPVPIRsj5R3L2VQF5PFLtR9YUQ3X/UGQnZAcmzn/2/tecSVJQqQqjXDigPIbsTxb7cKKrBUg6Z9RvOAGVThOy2SI3kbo5jU3W0C5A4AspFyPN5kBtQOQTKRIhAIDOBqomjmB+gw1FNzK/YfCXLElQe19oEOvYZAgkC1RqgcnFAsFfjyoFwr4Z3ILEkIIM26flArz4DoHJZQAa9GtcNlKQEiQUBGfRq+AYqlwWEezVmAw18lgwUZnF6IEEgHVB5GUDODWbiwoHcFlccFyACnXxJDyQIpAMqCdQAHfkQ6ORLBAJfWgRQc5Ls4d6W84CEDqhM23Y/2KLKw32d5gKVSwCqPRhdOpAichiYMAtILAZo2+h8cLpF4UygcglAsilDyTiMbQkBlFZocBTzMa5uDtB4D8sV6L3ycRsaNQ+oXBLQVK+75eIssgigzWuLTvTD/CKAXkvQvKU4NJidVEEnQEVKofTXYs21FoF0WQTQy/3d4B7XU59VQze3fgcviEUAmaUFavtUJ0fazwGqDYDSCdkCdTT+up5NgOosgOTmV9qpYPITu9sWyNvgBbEcoM36Wd44fjPdbBaiBMlNXwaQ3HI5QFxzqaHq8Tf16Uj708WZZllA8n7F+kuNxqi5pp2esnrBQM2+JR+b0z/nw3lxZhGmQMmEjtqDVo+uT6WyB6pNgBIWocRn0gQCWRIQvrPL4Wpk+lOWQMIcKJXQoJLGLWX4qWfWQO2XMFC6IjQ4zBu0lME6/KKBTGZ6T8w1nNtgZgOUSOiwRX4eO2kHJMyBkhWh1y2anog6a3Em6TZ6GUAGDWY2izOKHVAaoZnnQX6mZNoApSpCKU8UhSnQ8QzWuOOpBmtrdrL188ZthJAlUPclBKRejqfVx8qgkl49VvJqPl7HoTVQijm+g8P8XdtOqG0P8jQlc3wzEzOgNHN8j04UJZBu8IKvKZnFcHunQfIC6kuQ5inc3ibUjSapmgIlmcI6roMqzemitymZc4FSTEA8Porp706WvAQlBsLxNSVzNlCC+XV2a/M0JbN4rVAsgeJP/hldi7neecsKyAQkG6CN2nsqx7H2wYHK2Bet3RZt+8q563u3XYpdg5kLUGwhtUWD1jJN37zx4uCnyqNZqgsAGlyBxRjlOprmbAcUWagH8nSvcQIZLQ5+6ngeuCVQ3AFn6YCMQU6Aoja/LhUomlAPBDuVbRYHP6W504IJUMwilKRNejSL1x4oolAaIOEBKJJQKiALkBOgro9DWJ29h90iz4vTTwOHQO2/QsTp5UgEZANyHqgVitAEmwIIzHI2BOqJAjd/pAGyApkE6on8bsKcLfK7ODiJ1xyoM/K7DfZb5Hdxp/OfnIBCX7z6AbJoMDsze8URKOzFa+wSdG5ovStQ0PNqOyD3vvlz4359AAUTsuwXc+2bPzsw2hkopJANkHvP6vlRm+5AAYVsgJz75ieGlHkAClcNxSxBYmLElCvQ+OrVYpNwovTNjwcZegZSL/2lmedrsyh986PBCoZbbAnUX5p5vvqIch40GqwQCCiMUTQgTT+PPyD1vvZJFOVEcdQPFhqor7O7Os9SxGiLJjL3RLEQQtcI7RtIvXTFyLXOjnGYH/FEAir9NBcFP1EUJzzxgHwQBStBw+OJxy22/riYSAig6RPFUXvQoZIcnN4mTDwgPi2cOQmBQDzPOLy8BClBaetklByA3P7u9mfXr7t93M9CLxcI3wDFaKEXC4QvVs0WeqlABpcaZgu9VCDjsbDXCsQShIJ7NcwWerFApher1wt0hSEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiCQUECaW6Gplu2p9pKt9i5Y2q8arHp3W1g+bzcQ0FbTIrJ/aASqid8pb0OznRTSftVg1dvmT5bPfQgD1N7Uc+qP6g485/tmVaPl5B1odF81WLVaul2vcBigav0bGgByvpgYCEx91WDVu7f2T+ELAtT8EF1F0Ob8LfTVJoDbY+juvq9d9fbm73vbhziGAJIlGQFNtGqrwqEtItoGcf2qK9njaXnr9RBA4IaeMltNHQ2Apr5qsOpqZVA+RwkA1O4meqDJQoB3MW2HCli1qtvsbtPmF6h9HHvVDTM58zO6x7VP32sPVtL62/RpVi2j4O2q6hQnipr7xYLDvO6rBqtWXcPJd7E2GqDdraYQ6E8UtV81WLWsogb9wyZJANTtBxMKle5SQ/9VvOr2GajpD/MXFQKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQSO5AcrDZ4BGV8ZM7UP+U92TJHUiObX5vP/zbX7IHqjeWs088J3+grcG4zYDJHmj/8HPSWxJmD1St/7Mbluo5uQPJoc1uj351TO5Am3Zkc8JqOneg5CEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCD/A9QRurmkN2IjAAAAAElFTkSuQmCC" /><!-- --></p>
<p><span class="math inline">\(p_1\)</span>在0.5附近时为双峰，靠近0或1时为单峰</p>
</div>
<div id="exercise-3.20" class="section level2">
<h2>Exercise 3.20</h2>
<p>A <span class="math inline">\(compound\textit{ Poisson process is a
stochastic process }\{ X( t) , t\geq 0\}\)</span> that can be
represented as the random sum <span class="math inline">\(X( t) = \sum
_{i= 1}^{N( t) }Y_{i}\)</span>, <span class="math inline">\(t\geq
0\)</span>, where <span class="math inline">\(\{ N( t) , t\geq
0\}\)</span> is a Poisson process and <span class="math inline">\(Y_1,Y_2,\ldots\)</span> are iid and independent of
<span class="math inline">\(\{N(t),t\geq0\}.\)</span> Write a program to
simulate a compound Poisson(λ)–Gamma process (Y has a Gamma
distribution). Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the
parameters and compare with the theoretical value. Hint: Show that <span class="math inline">\(E[X(t)]=\lambda tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t))=\lambda tE[Y_1^2].\)</span></p>
<p>由条件期望及条件方差易知Hint成立。</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>rPoi_Gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(n,t,l,a,b)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>{</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  Nt <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n,t<span class="sc">*</span>l)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(Nt[i],<span class="at">shape=</span>a,<span class="at">rate=</span>b)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  }</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>}</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>) <span class="co">#lambda of poisson distribution</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>) <span class="co">#alpha of gamma distribution</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>) <span class="co">#beta of gamma distribution</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>tm <span class="ot">&lt;-</span> l<span class="sc">*</span>t<span class="sc">*</span>a<span class="sc">/</span>b <span class="co">#theoretical mean</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>tv <span class="ot">&lt;-</span> l<span class="sc">*</span>t<span class="sc">*</span>(a<span class="sc">/</span>b<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(a<span class="sc">/</span>b)<span class="sc">^</span><span class="dv">2</span>) <span class="co">#theoretical variance</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>rm <span class="ot">&lt;-</span> rv <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co">#real mean and variance</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rPoi_Gamma</span>(<span class="dv">1000</span>,t,l[i],a[i],b[i])</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>  rm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>  rv[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>}</span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="fu">rbind</span>(tm,rm,tv,rv)</span></code></pre></div>
<pre><code>##        [,1]     [,2]      [,3]
## tm 3.333333 20.00000  90.00000
## rm 3.276760 20.08241  89.15975
## tv 2.222222 30.00000 360.00000
## rv 2.306578 30.12009 355.67856</code></pre>
<p>均值、方差的理论值和实际值很接近</p>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="exercise-5.4" class="section level2">
<h2>Exercise 5.4</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3)
cdf, and use the function to estimate F(x) for x = 0.1, 0.2, . . ., 0.9.
Compare the estimates with the values returned by the pbeta function in
R.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>cdfbeta <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>{</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(N,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(s <span class="sc">&lt;=</span> x)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>}</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  x1[i] <span class="ot">&lt;-</span> <span class="fu">cdfbeta</span>(<span class="fl">0.1</span><span class="sc">*</span>i)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  x2[i] <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(<span class="fl">0.1</span><span class="sc">*</span>i,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>}</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>result <span class="ot">&lt;-</span><span class="fu">rbind</span>(x1,x2)</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="fu">row.names</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MC_estimation&quot;</span>,<span class="st">&quot;pbeta&quot;</span>)</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span><span class="sc">*</span><span class="fl">0.1</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>##                   0.1     0.2     0.3     0.4     0.5     0.6     0.7     0.8
## MC_estimation 0.00820 0.05821 0.16340 0.31568 0.50003 0.68075 0.83760 0.94255
## pbeta         0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208
##                   0.9
## MC_estimation 0.99102
## pbeta         0.99144</code></pre>
</div>
<div id="exercise-5.9" class="section level2">
<h2>Exercise 5.9</h2>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^{2}}\:e^{-x^{2}/(2\sigma^{2})},\quad
x\geq0,\:\sigma&gt;0.\]</span></p>
<p>Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution using antithetic
variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{\prime}}2\)</span> compared with <span class="math inline">\(\frac{X_{1}+X_{2}}{2}\)</span> for independent
<span class="math inline">\(X_1,X_2\)</span>?</p>
<p><span class="math display">\[
f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},x\geq0,\sigma&gt;0\\
F(x)=1-e^{-x^2/(2\sigma^2)}\\
F^{-1}(x)=\sqrt{-2\sigma^2\ln(1-x)}
\]</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>rRay_av <span class="ot">&lt;-</span> <span class="cf">function</span>(n,sigma)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>{</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(x1,x2))</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>}</span></code></pre></div>
<p>生成样本的方差为： <span class="math display">\[
\mathrm{Var}(\frac{X+X&#39;}2)=\frac14[\mathrm{Var}(X)+\mathrm{Var}(X&#39;)+2\mathrm{Cov}(X,X&#39;)]
\]</span> 方差缩减百分比为： <span class="math display">\[
\frac{-2\mathrm{Cov}(X,X&#39;)}{\mathrm{Var}(X)+\mathrm{Var}(X&#39;)}
\]</span> 其中： <span class="math display">\[
\mathrm{Var}(X)=\mathrm{Var}(X&#39;)=(2-\frac\pi2)\sigma^2\\
\mathrm{Cov}(X,X&#39;)=\mathrm E(XX&#39;)-\frac\pi
2\sigma^2=2\sigma^2\mathrm E(\sqrt{\ln(1-U)\ln (U)})-\frac\pi 2\sigma^2
\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sqrt</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">*</span><span class="fu">log</span>(u)))</span></code></pre></div>
<pre><code>## [1] 0.5815073</code></pre>
<p>由蒙特卡洛方法求得<span class="math inline">\(\mathrm
E(\sqrt{\ln(1-U)\ln (U)})\)</span>约为0.58 故方差缩减百分比约为95.7%</p>
</div>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are close to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}}\:e^{-x^2/2},\quad x&gt;1.
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\int_1^\infty\frac{x^2}{\sqrt{2\pi}}\:e^{-x^2/2}\:dx
\]</span> by importance sampling? Explain.</p>
<hr />
<p><span class="math display">\[
f_1(x)=\frac 2 {\sqrt{2\pi}}e^{-x^2/2},x&gt;0\\
f_2(x)=xe^{-x^2/2},x&gt;0\\
g(x)/f_1(x)=\frac{x^2} 2\\
g(x)/f_2(x)=\frac x{\sqrt{2\pi}}\\
\]</span></p>
<p>欲比较方差，只需比较<span class="math inline">\(\mathrm
E[(g(X_1)/f_1(X_1))^2]\)</span>与<span class="math inline">\(\mathrm
E[(g(X_2)/f_2(X_2))^2]\)</span>，其中<span class="math inline">\(X_1\sim
f_1,X_2\sim f_2\)</span>. <span class="math display">\[
\mathrm E[(g(X_1)/f_1(X_1))^2]=\frac{\mathrm E(\lvert
X_1&#39;\rvert^4)}{4}=\frac34,\:X_1&#39;\sim N(0,1)\\
\mathrm E[(g(X_2)/f_2(X_2))^2]=\frac{\mathrm
E(X_2^2)}{2\pi}=\frac1\pi,\:X_2\sim Rayleigh(1)
\]</span> <span class="math inline">\(f_2\)</span> 产生的方差更小</p>
</div>
<div id="monte-carlo-experiment" class="section level2">
<h2>Monte Carlo experiment</h2>
<ul>
<li>For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 ×
10^4, 8 × 10^4,\)</span> apply the fast sorting algorithm to randomly
permuted numbers of 1, . . . , n.</li>
<li>Calculate computation time averaged over 100 simulations,denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := nlog(n)\)</span>, and graphically show the
results (scatter plot and regression line).</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a> <span class="co"># Quick sort algorithm:</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a> quickSort <span class="ot">&lt;-</span> <span class="cf">function</span>(arr) {</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="co"># Pick a number at random.</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>   mid <span class="ot">&lt;-</span> <span class="fu">sample</span>(arr, <span class="dv">1</span>)</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>   <span class="co"># Place-holders for left and right values.</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>   left <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>   right <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="co"># Move all the smaller values to the left, bigger values to the right.</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>   <span class="fu">lapply</span>(arr[arr <span class="sc">!=</span> mid], <span class="cf">function</span>(d) {</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>    <span class="cf">if</span> (d <span class="sc">&lt;</span> mid) {</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>       left <span class="ot">&lt;&lt;-</span> <span class="fu">c</span>(left, d)</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>     }</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>     <span class="cf">else</span> {</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>      right <span class="ot">&lt;&lt;-</span> <span class="fu">c</span>(right, d)</span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>     }</span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a>   })</span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a>   <span class="cf">if</span> (<span class="fu">length</span>(left) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a>     left <span class="ot">&lt;-</span> <span class="fu">quickSort</span>(left)</span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a>   }</span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(right) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a>    right <span class="ot">&lt;-</span> <span class="fu">quickSort</span>(right)   }</span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a>   <span class="co"># Finally, return the sorted values.</span></span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a>  <span class="fu">c</span>(left, mid, right)</span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a> }</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)<span class="sc">*</span><span class="fl">1e2</span> <span class="co"># 4次幂时间过长，改为3次</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n[j])</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>    st <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>    nop <span class="ot">&lt;-</span> <span class="fu">quickSort</span>(x)</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>    et <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>    t[i] <span class="ot">&lt;-</span> et<span class="sc">-</span>st</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>  }</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>  a[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(t)</span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(a<span class="sc">~</span>x)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = a ~ x)
## 
## Coefficients:
## (Intercept)            x  
##  -2.767e-06    2.604e-06</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>c <span class="ot">&lt;-</span> m<span class="sc">$</span>coefficients</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">8e2</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="fu">plot</span>(n,a)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="fu">lines</span>(c[<span class="dv">2</span>]<span class="sc">*</span>x1<span class="sc">*</span><span class="fu">log</span>(x1)<span class="sc">+</span>c[<span class="dv">1</span>])</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAS1BMVEUAAAAAACsAAFUAK4AAVaorAAArACsrAFUrKysrgNRVAABVACtVqqpVqv+AKwCA1P+qVQCq///UgCvU////qlX/1ID//6r//9T///84jbM1AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG40lEQVR4nO2dgXabOBBFydbtrt117LqOw/9/aQEBjmuLN4IZNMC75ySHk0wEvpWERgi1KMkgRe4L8A4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgIoCyoWQy5BusUZ0LqhoAjFly/xHyif3zNF952CXpNLUHrflwnWIET9b8g+KE5fyynoJfcugIJe8aWLpKBnHu4gFPTE4x2Wgv7i7xEIBT3yNECjoAeeB7AU9IVX43sKuvMy/6Ggjkh+aCTo8z2kpP/8UiluBmLps42gS7EPB9fuYFJx9sSnF0wEfb73Wi7ffk8uzp6B2RcTQbfDsTu8PjYyn/NBQ1fDGjTQvJrfiotJOeelaKvQAvogUJmN7mK3Q2hIkfrjSBBq7BsfB+G+cNuCBPeKLQsS3Uo3LEg21DAaB93HO5FkI7sg6VDMpgZ9vkeTsDHFGSAeqZolqzvN4rSxWNWS+ImuxXHw91kFpSQ6W+ykkxLB7QlKTJQ3Jyh1HmFTM4pj5llmnlHMOh9UpDav8EfagaXX+aDwz+KiBsVnFEcVp0Tiep/ur9QDS6c1qG1dLgQ5nFHsWpePPsjfjGLbvEbcGzYxDppyz9yCoEljCmtBl+x3sYlDrtXXoKlD0pULmj5kX7cghYxm1cmqRsY3c7I6rrhx6CTE6001lCYM1pqsqs2njBDUpRHxJzvxGjTXfJBe+SMEnb/9vuzKj+8Djy0yJ6ua+tMF3Q778lrVi1jv0gZlTFZVq+cYQcfy499fzdcM500vWbfodEF1B3P7efIqSLt3G9EH1fnneT/cxPTOm1iserljbvPnXd3HoOUJSudNK1W/2DXlYiZjhxUJshlbrUaQ1dBzLYLMhubrEGSYuSxeULOFhOG4fOmCCtPqUy5eUPBjmtipB85aXJg3WZEg7fmgcSs2ks6gHjhjcalb/Iw6h3rgbMW1zct4cnK5gmZaxbdUQbOtclyooPkWgS5S0JyLZJcoaNY1xMsTNPMS68UJmnsJ+sIEzb9Cf1GCcrzBsCRBmV7w0A60Ki7ThihGgi7Vx2nWL6itcs21X4yNoMvbqbwd6vd6lQTl207HRFBYH/T5Xq8B0dg/KOd2QyaCuhVm9UoihRqUdTcmwxpU1k/xpwvKvFuVUR/UaomvcZCfN6sew7tYaGTRPSqExeXW43wc5GEvOM+CHOgxEzTpVYR5ZuOFGHXSU15FaO240GN9mx/zKkJ4FOhEj/FAsRzzKoL94/YkHNagURskmGHVB41+FcF+OUIaRnex0a8iNLXHTw/kbRzkSk3AkyCHelwNFD3qmX2gGJ8w86nHzW3eZetqyDpQ7LT41ZO3BrVfnvVkHSj6rz01GQeKzrLSCBnHQc6y0gg5B4rFAvyYC4o/9sm232Qa2WrQAtw0ZBS0EDIJGiw0kupPD9Y4XwzlZHWw0PULwk81BgtdvSBBqjFY6OoFCZLVwUJXL4g1CIGT1cFC1y8IJ6uDhW5A0LRCKWiNUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIICioHYf4WtRvJ0eDp65PMXEg8MUy04UfG2f6RxllyFBT9Dt0EzDXqurqb/uB8/Uz2UfYwaCP360P5YEhwvZyYMhaoKu4WFQmJY97+4Hz9Sbnzf/6a8kuJ/+FgXX1PrFwRAtQddi33ySsCd+dY39QeQPakGi4Ev74aQlf3zfJ1wGRLEPCoKaBlEd9geR6PoVc1Hw+b+qU9nLSz4nXQZEW1Bo7tX3/uB1bPOZJcG3Qz0Bft5LS27arzRYQCZB4fV7+ceoypaq//Jbj4Lkdbu6aHlw1ZUIg8/NExe/TUzeO9afWR784yQLDi3McSctub+Gi67C1YO7cIe3+bKrx5IRWt0MmisXBdcf7iwM7n/ub6DYN/Q+jbjEx/jnottmRzu4b0ySYAlMVgEUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQDvgm6H/w9FccSBVvgX9HZqlgznwr+gfll4HvwLOj7syzM7FASgIAAFASgIQEEA74KyQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAf4A2DTFRwxjgrkAAAAASUVORK5CYII=" /><!-- -->
# HW3</p>
</div>
<div id="exercise-6.6" class="section level2">
<h2>Exercise 6.6</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
√b1 under normality by a Monte Carlo experiment. Compute the standard
error of the estimates from (2.14) using the normal approximation for
the density (with exact variance formula). Compare the estimated
quantiles with the quantiles of the large sample approximation √b1 ≈
N(0, 6/n).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="co">#计算样本偏度</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="fu">return</span>(m3<span class="sc">/</span>m2<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n,<span class="fu">sk</span>(<span class="fu">rnorm</span>(m)))</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>))<span class="co">#估计分位数</span></span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1517840 -0.1316856  0.1391613  0.1651871</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n))<span class="co">#大样本近似</span></span></code></pre></div>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
</div>
<div id="exercise-6.b" class="section level2">
<h2>Exercise 6.B</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>,Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in <span class="math inline">\(\mathbf{cor.test}\)</span>. Show
(empirically) that the nonparametric tests based on <span class="math inline">\(\rho_{s}\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X,Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
<div id="二元正态情形" class="section level3">
<h3>二元正态情形</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="co">#二元正态</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co">#置信水平</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="co">#相关系数</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#蒙特卡洛重复次数</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(rho, size)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>{</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  pearson <span class="ot">&lt;-</span> pearson.sd <span class="ot">&lt;-</span> kendall <span class="ot">&lt;-</span> kendall.sd <span class="ot">&lt;-</span> spearman <span class="ot">&lt;-</span> spearman.sd <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  <span class="cf">for</span>(n <span class="cf">in</span> size){</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, {</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>      S <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> n, <span class="at">Sigma =</span> S, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fu">cor.test</span>(x[,<span class="dv">1</span>], x[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha,</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>      <span class="fu">cor.test</span>(x[,<span class="dv">1</span>], x[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha,</span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>      <span class="fu">cor.test</span>(x[,<span class="dv">1</span>], x[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha)</span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>    })</span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>    pearson[n] <span class="ot">&lt;-</span> <span class="fu">mean</span>(result[<span class="dv">1</span>,])</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>    <span class="co">#pearson.sd[n] &lt;- sd(result[1,])</span></span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a>    kendall[n] <span class="ot">&lt;-</span> <span class="fu">mean</span>(result[<span class="dv">2</span>,])</span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>    <span class="co">#kendall.sd[n] &lt;- sd(result[2,])</span></span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a>    spearman[n] <span class="ot">&lt;-</span> <span class="fu">mean</span>(result[<span class="dv">3</span>,])</span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a>    <span class="co">#spearman.sd[n] &lt;- sd(result[3,])</span></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a>  }</span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a>  <span class="fu">plot</span>(pearson, <span class="at">xlim =</span> <span class="fu">c</span>(size[<span class="dv">1</span>],size[<span class="fu">length</span>(size)]), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">bquote</span>(rho <span class="sc">==</span> .(rho)),</span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;样本量&quot;</span>,</span>
<span id="cb34-29"><a href="#cb34-29" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;检验功效&quot;</span>,</span>
<span id="cb34-30"><a href="#cb34-30" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb34-31"><a href="#cb34-31" tabindex="-1"></a>  <span class="fu">points</span>(kendall, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb34-32"><a href="#cb34-32" tabindex="-1"></a>  <span class="fu">points</span>(spearman, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb34-33"><a href="#cb34-33" tabindex="-1"></a>  <span class="fu">lines</span>(pearson, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb34-34"><a href="#cb34-34" tabindex="-1"></a>  <span class="fu">lines</span>(kendall, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb34-35"><a href="#cb34-35" tabindex="-1"></a>  <span class="fu">lines</span>(spearman, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb34-36"><a href="#cb34-36" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb34-37"><a href="#cb34-37" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>), </span>
<span id="cb34-38"><a href="#cb34-38" tabindex="-1"></a>         <span class="at">lwd =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>), </span>
<span id="cb34-39"><a href="#cb34-39" tabindex="-1"></a>         <span class="at">pch =</span> <span class="fu">rep</span>(<span class="dv">16</span>,<span class="dv">3</span>),</span>
<span id="cb34-40"><a href="#cb34-40" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>, <span class="st">&quot;kendall&quot;</span>, <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb34-41"><a href="#cb34-41" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">f</span>(<span class="fl">0.8</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">30</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">f</span>(<span class="fl">0.5</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">60</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">f</span>(<span class="fl">0.3</span>, <span class="dv">20</span><span class="sc">:</span><span class="dv">120</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>可以看出,二元正态情形下,对于不同的<span class="math inline">\(\rho\)</span>, Pearson相关系数的检验功效均高于
Spearman 相关系数和 Kendall <span class="math inline">\(\tau\)</span>
相关系数</p>
</div>
<div id="example" class="section level3">
<h3>Example</h3>
<p>Set <span class="math inline">\(X=U,Y=\frac 1 V\)</span>,where <span class="math inline">\((U,V)\sim N_2(\mu,\Sigma)\)</span>, and <span class="math inline">\(\mu=(0,0)^T,\Sigma=\left(\begin{matrix}1&amp;\rho\\
\rho&amp;1 \end{matrix}\right)\)</span>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co">#对Y取倒数</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>pearson <span class="ot">&lt;-</span> pearson.sd <span class="ot">&lt;-</span> kendall <span class="ot">&lt;-</span> kendall.sd <span class="ot">&lt;-</span> spearman <span class="ot">&lt;-</span> spearman.sd <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a><span class="cf">for</span>(n <span class="cf">in</span> size){</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, {</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>    S <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> n, <span class="at">Sigma =</span> S, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>    x[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>x[,<span class="dv">2</span>]</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">cor.test</span>(x[,<span class="dv">1</span>], x[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha,</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>    <span class="fu">cor.test</span>(x[,<span class="dv">1</span>], x[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha,</span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>    <span class="fu">cor.test</span>(x[,<span class="dv">1</span>], x[,<span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha)</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>  })</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>  pearson[n] <span class="ot">&lt;-</span> <span class="fu">mean</span>(result[<span class="dv">1</span>,])</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>  <span class="co">#pearson.sd[n] &lt;- sd(result[1,])</span></span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>  kendall[n] <span class="ot">&lt;-</span> <span class="fu">mean</span>(result[<span class="dv">2</span>,])</span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a>  <span class="co">#kendall.sd[n] &lt;- sd(result[2,])</span></span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>  spearman[n] <span class="ot">&lt;-</span> <span class="fu">mean</span>(result[<span class="dv">3</span>,])</span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>  <span class="co">#spearman.sd[n] &lt;- sd(result[3,])</span></span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a>}</span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a><span class="fu">plot</span>(pearson, <span class="at">xlim =</span> <span class="fu">c</span>(size[<span class="dv">1</span>],size[<span class="fu">length</span>(size)]), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;样本量&quot;</span>,</span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;检验功效&quot;</span>,</span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a><span class="fu">points</span>(kendall, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb38-28"><a href="#cb38-28" tabindex="-1"></a><span class="fu">points</span>(spearman, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb38-29"><a href="#cb38-29" tabindex="-1"></a><span class="fu">lines</span>(pearson, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb38-30"><a href="#cb38-30" tabindex="-1"></a><span class="fu">lines</span>(kendall, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb38-31"><a href="#cb38-31" tabindex="-1"></a><span class="fu">lines</span>(spearman, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb38-32"><a href="#cb38-32" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, </span>
<span id="cb38-33"><a href="#cb38-33" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>), </span>
<span id="cb38-34"><a href="#cb38-34" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>), </span>
<span id="cb38-35"><a href="#cb38-35" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">rep</span>(<span class="dv">16</span>,<span class="dv">3</span>),</span>
<span id="cb38-36"><a href="#cb38-36" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>, <span class="st">&quot;kendall&quot;</span>, <span class="st">&quot;spearman&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level.</p>
<ul>
<li><p>What is the corresponding hypothesis test problem? <span class="math display">\[
H_0:P_{1}(reject\ H&#39;_0\ |\ H&#39;_a)-P_{2}(reject\ H&#39;_0\ |\
H&#39;_a)=0\leftrightarrow H_a:P_{1}(reject\ H&#39;_0\ |\
H&#39;_a)-P_{2}(reject\ H&#39;_0\ |\ H&#39;_a)\neq0
\]</span></p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test
or McNemar test? Why?
两样本t检验。大样本情形下功效近似正态分布，因此为两个正态总体均值差的假设检验。</p></li>
<li><p>Please provide the least necessary information for hypothesis
testing. 样本均值及方差</p></li>
</ul>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="question-1" class="section level3">
<h3>Question</h3>
<p>Of <span class="math inline">\(N=1000\)</span> hypotheses, 950 are
null and 50 are alternative. The p-value under any null hypothesis is
uniformly distributed (use runif), and the p-value under any alternative
hypothesis follows the beta distribution with parameter 0.1 and 1 (use
rbeta). Obtain Bonferroni adjusted p-values and B-H adjusted p-values.
Calculate FWER, FDR, and TPR under nominal level <span class="math inline">\(\alpha=0.1\)</span> for each of the two adjustment
methods based on <span class="math inline">\(m=10000\)</span> simulation
replicates. You should output the 6 numbers (3) to a <span class="math inline">\(3\times2\)</span> table (column names: Bonferroni
correction, B-H correction; row names: FWER, FDR, TPR). Comment the
results.</p>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>n_null <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>n_alt <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>fwer_bonferroni <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>fdr_bonferroni <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>tpr_bonferroni <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>fwer_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>fdr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>tpr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  <span class="co"># Generate p-values</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>  p_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_null)  <span class="co"># Null hypothesis p-values</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>  p_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_alt, <span class="fl">0.1</span>, <span class="dv">1</span>)  <span class="co"># Alternative hypothesis p-values</span></span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_null, p_alt)  <span class="co"># Combine all p-values</span></span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>  <span class="co"># Bonferroni correction</span></span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>  p_bonferroni <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>  reject_bonferroni <span class="ot">&lt;-</span> p_bonferroni <span class="sc">&lt;</span> alpha</span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a>  </span>
<span id="cb39-25"><a href="#cb39-25" tabindex="-1"></a>  <span class="co"># FWER and TPR calculation for Bonferroni</span></span>
<span id="cb39-26"><a href="#cb39-26" tabindex="-1"></a>  fwer_bonferroni[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_bonferroni[<span class="dv">1</span><span class="sc">:</span>n_null])  <span class="co"># Type I error rate</span></span>
<span id="cb39-27"><a href="#cb39-27" tabindex="-1"></a>  tpr_bonferroni[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bonferroni[(n_null <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n_null <span class="sc">+</span> n_alt)]) <span class="sc">/</span> n_alt  <span class="co"># True Positive Rate</span></span>
<span id="cb39-28"><a href="#cb39-28" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" tabindex="-1"></a>  <span class="co"># FDR calculation for Bonferroni</span></span>
<span id="cb39-30"><a href="#cb39-30" tabindex="-1"></a>  num_rejected_bonferroni <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bonferroni)</span>
<span id="cb39-31"><a href="#cb39-31" tabindex="-1"></a>  num_false_rejections_bonferroni <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bonferroni[<span class="dv">1</span><span class="sc">:</span>n_null])</span>
<span id="cb39-32"><a href="#cb39-32" tabindex="-1"></a>  <span class="cf">if</span> (num_rejected_bonferroni <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb39-33"><a href="#cb39-33" tabindex="-1"></a>    fdr_bonferroni[i] <span class="ot">&lt;-</span> num_false_rejections_bonferroni <span class="sc">/</span> num_rejected_bonferroni</span>
<span id="cb39-34"><a href="#cb39-34" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb39-35"><a href="#cb39-35" tabindex="-1"></a>    fdr_bonferroni[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-36"><a href="#cb39-36" tabindex="-1"></a>  }</span>
<span id="cb39-37"><a href="#cb39-37" tabindex="-1"></a></span>
<span id="cb39-38"><a href="#cb39-38" tabindex="-1"></a>  <span class="co"># B-H correction</span></span>
<span id="cb39-39"><a href="#cb39-39" tabindex="-1"></a>  p_bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb39-40"><a href="#cb39-40" tabindex="-1"></a>  reject_bh <span class="ot">&lt;-</span> p_bh <span class="sc">&lt;</span> alpha</span>
<span id="cb39-41"><a href="#cb39-41" tabindex="-1"></a></span>
<span id="cb39-42"><a href="#cb39-42" tabindex="-1"></a>  fwer_bh[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_bh[<span class="dv">1</span><span class="sc">:</span>n_null])  <span class="co"># Type I error rate</span></span>
<span id="cb39-43"><a href="#cb39-43" tabindex="-1"></a>  num_rejected_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh)  <span class="co"># Total rejections</span></span>
<span id="cb39-44"><a href="#cb39-44" tabindex="-1"></a>  num_true_rejections_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh[(n_null <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n_null <span class="sc">+</span> n_alt)])  <span class="co"># True positives</span></span>
<span id="cb39-45"><a href="#cb39-45" tabindex="-1"></a>  num_false_rejections_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh[<span class="dv">1</span><span class="sc">:</span>n_null])  <span class="co"># False positives</span></span>
<span id="cb39-46"><a href="#cb39-46" tabindex="-1"></a></span>
<span id="cb39-47"><a href="#cb39-47" tabindex="-1"></a>  <span class="co"># FDR calculation for B-H</span></span>
<span id="cb39-48"><a href="#cb39-48" tabindex="-1"></a>  <span class="cf">if</span> (num_rejected_bh <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb39-49"><a href="#cb39-49" tabindex="-1"></a>    fdr_bh[i] <span class="ot">&lt;-</span> num_false_rejections_bh <span class="sc">/</span> num_rejected_bh</span>
<span id="cb39-50"><a href="#cb39-50" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb39-51"><a href="#cb39-51" tabindex="-1"></a>    fdr_bh[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-52"><a href="#cb39-52" tabindex="-1"></a>  }</span>
<span id="cb39-53"><a href="#cb39-53" tabindex="-1"></a></span>
<span id="cb39-54"><a href="#cb39-54" tabindex="-1"></a>  <span class="co"># TPR calculation for B-H</span></span>
<span id="cb39-55"><a href="#cb39-55" tabindex="-1"></a>  tpr_bh[i] <span class="ot">&lt;-</span> num_true_rejections_bh <span class="sc">/</span> n_alt</span>
<span id="cb39-56"><a href="#cb39-56" tabindex="-1"></a>}</span>
<span id="cb39-57"><a href="#cb39-57" tabindex="-1"></a></span>
<span id="cb39-58"><a href="#cb39-58" tabindex="-1"></a>mean_fwer_bonferroni <span class="ot">&lt;-</span> <span class="fu">mean</span>(fwer_bonferroni)</span>
<span id="cb39-59"><a href="#cb39-59" tabindex="-1"></a>mean_fdr_bonferroni <span class="ot">&lt;-</span> <span class="fu">mean</span>(fdr_bonferroni)</span>
<span id="cb39-60"><a href="#cb39-60" tabindex="-1"></a>mean_fdr_bh <span class="ot">&lt;-</span> <span class="fu">mean</span>(fdr_bh)</span>
<span id="cb39-61"><a href="#cb39-61" tabindex="-1"></a>mean_fwer_bh <span class="ot">&lt;-</span> <span class="fu">mean</span>(fwer_bh)</span>
<span id="cb39-62"><a href="#cb39-62" tabindex="-1"></a>mean_tpr_bonferroni <span class="ot">&lt;-</span> <span class="fu">mean</span>(tpr_bonferroni)</span>
<span id="cb39-63"><a href="#cb39-63" tabindex="-1"></a>mean_tpr_bh <span class="ot">&lt;-</span> <span class="fu">mean</span>(tpr_bh)</span>
<span id="cb39-64"><a href="#cb39-64" tabindex="-1"></a></span>
<span id="cb39-65"><a href="#cb39-65" tabindex="-1"></a></span>
<span id="cb39-66"><a href="#cb39-66" tabindex="-1"></a><span class="co"># Create results matrix</span></span>
<span id="cb39-67"><a href="#cb39-67" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(mean_fwer_bonferroni, mean_fdr_bonferroni, mean_tpr_bonferroni,mean_fwer_bh, mean_fdr_bh, mean_tpr_bh), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb39-68"><a href="#cb39-68" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>, <span class="st">&quot;B-H&quot;</span>)</span>
<span id="cb39-69"><a href="#cb39-69" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb39-70"><a href="#cb39-70" tabindex="-1"></a></span>
<span id="cb39-71"><a href="#cb39-71" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>##        Bonferroni         B-H
## FWER 9.315789e-05 0.003231579
## FDR  4.357993e-03 0.094802237
## TPR  3.977780e-01 0.561214000</code></pre>
<p><em>Comment:</em> Bonferroni is more robust than B-H method.</p>
</div>
<div id="exercise-7.4" class="section level2">
<h2>Exercise 7.4</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
airconditioning equipment [63, Example 1.1]:</p>
<p><span class="math display">\[3,5,7,18,43,85,91,98,100,130,230,487.\]</span>
Assume that the times between failures follow an exponential model
Exp<span class="math inline">\((\lambda).\)</span> Obtain the MLE of the
hazard rate <span class="math inline">\(\lambda\)</span> and use
bootstrap to estimate the bias and standard error of the estimate.</p>
<p><span class="math display">\[\hat\lambda=\frac{n}{\sum_{i=1}^n x_i}
\]</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a><span class="co"># Function to calculate the MLE of lambda</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>mle_lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]  <span class="co"># Resample with replacement</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_data)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>  <span class="fu">return</span>(n <span class="sc">/</span> <span class="fu">sum</span>(sample_data))</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>}</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a><span class="co"># Calculate the MLE of lambda from the original data</span></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>original_lambda <span class="ot">&lt;-</span> <span class="fu">mle_lambda</span>(data, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(data))</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a><span class="co"># Perform bootstrap</span></span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>n_boot <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of bootstrap samples</span></span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, mle_lambda, <span class="at">R =</span> n_boot)</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a><span class="co"># Bias and standard error</span></span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results<span class="sc">$</span>t) <span class="sc">-</span> original_lambda</span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a><span class="co"># Summary results</span></span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE of λ:&quot;</span>, original_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MLE of λ: 0.00925212</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap Bias:&quot;</span>, bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bootstrap Bias: 0.001372445</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap Standard Error:&quot;</span>, se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bootstrap Standard Error: 0.004393735</code></pre>
</div>
<div id="exercise-7.5" class="section level2">
<h2>Exercise 7.5</h2>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95\%\)</span> bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="co"># Mean time between failures</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>mean_time_between_failures <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> original_lambda</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="co"># Calculate the bootstrap estimates for mean time between failures</span></span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>boot_mean_times <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> boot_results<span class="sc">$</span>t</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a><span class="co"># Standard Normal Method CI</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)  </span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_mean_times)</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>ci_normal <span class="ot">&lt;-</span> mean_time_between_failures <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>z <span class="sc">*</span> se, z <span class="sc">*</span> se)</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a><span class="co"># Basic Method CI</span></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>ci_basic <span class="ot">&lt;-</span> mean_time_between_failures <span class="sc">+</span> <span class="fu">c</span>(<span class="fu">mean</span>(boot_mean_times) <span class="sc">-</span> <span class="fu">mean</span>(boot_mean_times), <span class="fu">mean</span>(boot_mean_times) <span class="sc">-</span> <span class="fu">mean</span>(boot_mean_times))</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a><span class="co"># Percentile Method CI</span></span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>ci_percentile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_mean_times, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a><span class="co"># BCa Method CI</span></span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>ci_bca <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a><span class="co"># Extract BCa CI limits</span></span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>bca_limits <span class="ot">&lt;-</span> ci_bca<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]  </span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a><span class="co"># Combine results</span></span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;Standard Normal&quot;</span>, <span class="st">&quot;Basic&quot;</span>, <span class="st">&quot;Percentile&quot;</span>, <span class="st">&quot;BCa&quot;</span>),</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>  <span class="at">Lower_CI =</span> <span class="fu">c</span>(ci_normal[<span class="dv">1</span>], ci_basic[<span class="dv">1</span>], ci_percentile[<span class="dv">1</span>], bca_limits[<span class="dv">1</span>]),</span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a>  <span class="at">Upper_CI =</span> <span class="fu">c</span>(ci_normal[<span class="dv">2</span>], ci_basic[<span class="dv">2</span>], ci_percentile[<span class="dv">2</span>], bca_limits[<span class="dv">2</span>])</span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a>)</span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##            Method     Lower_CI     Upper_CI
## 1 Standard Normal 3.304664e+01 183.12002697
## 2           Basic 1.080833e+02 108.08333333
## 3      Percentile 4.658333e+01 192.17500000
## 4             BCa 4.520685e-03   0.01812689</code></pre>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="section" class="section level2">
<h2>7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> scor</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(scores)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>eigen_values <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov_matrix)<span class="sc">$</span>values</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> eigen_values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eigen_values)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scores)</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>jackknife_estimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  jackknife_sample <span class="ot">&lt;-</span> scores[<span class="sc">-</span>i, ]</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  jackknife_cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(jackknife_sample)</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>  jackknife_eigen_values <span class="ot">&lt;-</span> <span class="fu">eigen</span>(jackknife_cov_matrix)<span class="sc">$</span>values</span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  jackknife_estimates[i] <span class="ot">&lt;-</span> jackknife_eigen_values[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(jackknife_eigen_values)</span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>}</span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(jackknife_estimates) <span class="sc">-</span> theta_hat)</span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>jackknife_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> <span class="fu">sum</span>((jackknife_estimates <span class="sc">-</span> <span class="fu">mean</span>(jackknife_estimates))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Jackknife Bias: &quot;</span>, bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Jackknife Bias:  0.001069139</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Jackknife Standard Error: &quot;</span>, jackknife_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Jackknife Standard Error:  0.04955231</code></pre>
</div>
<div id="section-1" class="section level2">
<h2>7.10</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">data</span>(ironslag)</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>chemical <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>magnetic <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> e5 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(J1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> chemical[k]))</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(J2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> chemical[k]))</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(J3, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> chemical[k]))</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a></span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(J4, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> chemical[k]))</span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a>}</span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a></span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a><span class="fu">print</span>(mse)</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>adj_r2 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical))<span class="sc">$</span>adj.r.squared,</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">$</span>adj.r.squared,</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical))<span class="sc">$</span>adj.r.squared,</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>)))<span class="sc">$</span>adj.r.squared</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>)</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a><span class="fu">print</span>(adj_r2)</span></code></pre></div>
<pre><code>## [1] 0.5281545 0.5768151 0.5280556 0.5740396</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>best_model_mse <span class="ot">&lt;-</span> <span class="fu">which.min</span>(mse)</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>best_model_adj_r2 <span class="ot">&lt;-</span> <span class="fu">which.max</span>(adj_r2)</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MSE best model&quot;</span>, best_model_mse, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MSE best model 2</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;R-squared best model&quot;</span>, best_model_adj_r2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## R-squared best model 2</code></pre>
</div>
<div id="section-2" class="section level2">
<h2>8.1</h2>
<p>Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">158</span>, <span class="dv">171</span>, <span class="dv">193</span>, <span class="dv">199</span>, <span class="dv">230</span>, <span class="dv">243</span>, <span class="dv">248</span>, <span class="dv">248</span>, <span class="dv">250</span>, <span class="dv">267</span>, <span class="dv">271</span>, <span class="dv">316</span>, <span class="dv">327</span>, <span class="dv">329</span>)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">141</span>, <span class="dv">148</span>, <span class="dv">169</span>, <span class="dv">181</span>, <span class="dv">203</span>, <span class="dv">213</span>, <span class="dv">229</span>, <span class="dv">244</span>, <span class="dv">257</span>, <span class="dv">260</span>, <span class="dv">271</span>, <span class="dv">309</span>)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>cramer_von_mises <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>  ranks <span class="ot">&lt;-</span> <span class="fu">rank</span>(combined)</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>  Rx <span class="ot">&lt;-</span> <span class="fu">sum</span>(ranks[<span class="dv">1</span><span class="sc">:</span>n])<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>  Ry <span class="ot">&lt;-</span> <span class="fu">sum</span>(ranks[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> m)])<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (m<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>  <span class="fu">return</span>((Rx <span class="sc">+</span> Ry) <span class="sc">/</span> (n <span class="sc">+</span> m) <span class="sc">-</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> m<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> ((n <span class="sc">+</span> m)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>}</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>observed_stat <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises</span>(x, y)</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb64-17"><a href="#cb64-17" tabindex="-1"></a>n_permutations <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb64-18"><a href="#cb64-18" tabindex="-1"></a>permutation_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_permutations)</span>
<span id="cb64-19"><a href="#cb64-19" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb64-21"><a href="#cb64-21" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb64-22"><a href="#cb64-22" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb64-23"><a href="#cb64-23" tabindex="-1"></a></span>
<span id="cb64-24"><a href="#cb64-24" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb64-25"><a href="#cb64-25" tabindex="-1"></a>  permuted_data <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined_data)</span>
<span id="cb64-26"><a href="#cb64-26" tabindex="-1"></a>  perm_x <span class="ot">&lt;-</span> permuted_data[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb64-27"><a href="#cb64-27" tabindex="-1"></a>  perm_y <span class="ot">&lt;-</span> permuted_data[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> m)]</span>
<span id="cb64-28"><a href="#cb64-28" tabindex="-1"></a>  permutation_stats[i] <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises</span>(perm_x, perm_y)</span>
<span id="cb64-29"><a href="#cb64-29" tabindex="-1"></a>}</span>
<span id="cb64-30"><a href="#cb64-30" tabindex="-1"></a></span>
<span id="cb64-31"><a href="#cb64-31" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(permutation_stats <span class="sc">&gt;=</span> observed_stat)</span>
<span id="cb64-32"><a href="#cb64-32" tabindex="-1"></a></span>
<span id="cb64-33"><a href="#cb64-33" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Observed Cramér-von Mises statistic:&quot;</span>, observed_stat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Observed Cramér-von Mises statistic: 13.48162</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value from permutation test:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value from permutation test: 0.677</code></pre>
</div>
<div id="section-3" class="section level2">
<h2>8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>)</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>spearman_stat <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>n_permutations <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>permutation_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_permutations)</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>  permuted_y <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)</span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>  permutation_stats[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, permuted_y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a>}</span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>p_value_perm <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(permutation_stats) <span class="sc">&gt;=</span> <span class="fu">abs</span>(spearman_stat))</span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a>cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a>p_value_cor_test <span class="ot">&lt;-</span> cor_test_result<span class="sc">$</span>p.value</span>
<span id="cb68-19"><a href="#cb68-19" tabindex="-1"></a></span>
<span id="cb68-20"><a href="#cb68-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Observed Spearman statistic:&quot;</span>, spearman_stat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Observed Spearman statistic: 0.01134594</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value from permutation test:&quot;</span>, p_value_perm, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value from permutation test: 0.949</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value from cor.test:&quot;</span>, p_value_cor_test, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value from cor.test: 0.9531738</code></pre>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="section-4" class="section level2">
<h2>9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see qcauchy or qt with df=1).<br />
</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a><span class="co"># Metropolis-Hastings sampler for the standard Cauchy distribution</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>metropolis_hastings_cauchy <span class="ot">&lt;-</span> <span class="cf">function</span>(n, burn_in) {</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>  samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)  <span class="co"># Initial value</span></span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>    <span class="co"># Propose a new sample</span></span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, samples[i <span class="sc">-</span> <span class="dv">1</span>], <span class="dv">1</span>)  <span class="co"># Normal proposal</span></span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(y) <span class="sc">/</span> <span class="fu">dcauchy</span>(samples[i <span class="sc">-</span> <span class="dv">1</span>])  <span class="co"># Acceptance ratio</span></span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fu">min</span>(<span class="dv">1</span>, r)) {</span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> y  <span class="co"># Accept the new sample</span></span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> samples[i <span class="sc">-</span> <span class="dv">1</span>]  <span class="co"># Reject and keep the old sample</span></span>
<span id="cb74-17"><a href="#cb74-17" tabindex="-1"></a>    }</span>
<span id="cb74-18"><a href="#cb74-18" tabindex="-1"></a>  }</span>
<span id="cb74-19"><a href="#cb74-19" tabindex="-1"></a></span>
<span id="cb74-20"><a href="#cb74-20" tabindex="-1"></a>  <span class="fu">return</span>(samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)])  <span class="co"># Discard burn-in samples</span></span>
<span id="cb74-21"><a href="#cb74-21" tabindex="-1"></a>}</span>
<span id="cb74-22"><a href="#cb74-22" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" tabindex="-1"></a><span class="co"># Run multiple chains for convergence check</span></span>
<span id="cb74-24"><a href="#cb74-24" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb74-25"><a href="#cb74-25" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb74-26"><a href="#cb74-26" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb74-27"><a href="#cb74-27" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb74-28"><a href="#cb74-28" tabindex="-1"></a>chains_cauchy <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>num_chains, <span class="cf">function</span>(i) <span class="fu">metropolis_hastings_cauchy</span>(n_samples, burn_in))</span>
<span id="cb74-29"><a href="#cb74-29" tabindex="-1"></a></span>
<span id="cb74-30"><a href="#cb74-30" tabindex="-1"></a><span class="co"># Check convergence using Gelman-Rubin statistic</span></span>
<span id="cb74-31"><a href="#cb74-31" tabindex="-1"></a>R_cauchy <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb74-32"><a href="#cb74-32" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(chains)  <span class="co"># Number of chains</span></span>
<span id="cb74-33"><a href="#cb74-33" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, length)  <span class="co"># Length of each chain</span></span>
<span id="cb74-34"><a href="#cb74-34" tabindex="-1"></a>  theta_hat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, mean)  <span class="co"># Mean of each chain</span></span>
<span id="cb74-35"><a href="#cb74-35" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">var</span>(theta_hat) <span class="sc">*</span> n[<span class="dv">1</span>] <span class="sc">/</span> (m <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Between-chain variance</span></span>
<span id="cb74-36"><a href="#cb74-36" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(chains, var))  <span class="co"># Within-chain variance</span></span>
<span id="cb74-37"><a href="#cb74-37" tabindex="-1"></a>  var_theta_hat <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> m) <span class="sc">*</span> W <span class="sc">+</span> B <span class="sc">/</span> m  <span class="co"># Total variance estimate</span></span>
<span id="cb74-38"><a href="#cb74-38" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(var_theta_hat <span class="sc">/</span> W))  <span class="co"># Gelman-Rubin statistic</span></span>
<span id="cb74-39"><a href="#cb74-39" tabindex="-1"></a>}</span>
<span id="cb74-40"><a href="#cb74-40" tabindex="-1"></a></span>
<span id="cb74-41"><a href="#cb74-41" tabindex="-1"></a><span class="co"># Run until convergence</span></span>
<span id="cb74-42"><a href="#cb74-42" tabindex="-1"></a>R_value <span class="ot">&lt;-</span> <span class="fu">R_cauchy</span>(chains_cauchy)</span>
<span id="cb74-43"><a href="#cb74-43" tabindex="-1"></a>timer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb74-44"><a href="#cb74-44" tabindex="-1"></a><span class="cf">while</span> (R_value <span class="sc">&gt;=</span> <span class="fl">1.2</span>) {</span>
<span id="cb74-45"><a href="#cb74-45" tabindex="-1"></a>  timer <span class="ot">&lt;-</span> timer <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb74-46"><a href="#cb74-46" tabindex="-1"></a>  chains_cauchy <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>num_chains, <span class="cf">function</span>(i) <span class="fu">metropolis_hastings_cauchy</span>(n_samples, burn_in))</span>
<span id="cb74-47"><a href="#cb74-47" tabindex="-1"></a>  R_value <span class="ot">&lt;-</span> <span class="fu">R_cauchy</span>(chains_cauchy)</span>
<span id="cb74-48"><a href="#cb74-48" tabindex="-1"></a>  <span class="cf">if</span>(timer <span class="sc">&gt;=</span> <span class="dv">100</span>) <span class="cf">break</span></span>
<span id="cb74-49"><a href="#cb74-49" tabindex="-1"></a>}</span>
<span id="cb74-50"><a href="#cb74-50" tabindex="-1"></a></span>
<span id="cb74-51"><a href="#cb74-51" tabindex="-1"></a><span class="co"># Calculate deciles of the samples</span></span>
<span id="cb74-52"><a href="#cb74-52" tabindex="-1"></a>combined_samples <span class="ot">&lt;-</span> <span class="fu">unlist</span>(chains_cauchy)</span>
<span id="cb74-53"><a href="#cb74-53" tabindex="-1"></a>sample_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(combined_samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb74-54"><a href="#cb74-54" tabindex="-1"></a>theoretical_deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb74-55"><a href="#cb74-55" tabindex="-1"></a></span>
<span id="cb74-56"><a href="#cb74-56" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb74-57"><a href="#cb74-57" tabindex="-1"></a><span class="fu">print</span>(sample_deciles)</span></code></pre></div>
<pre><code>##         10%         20%         30%         40%         50%         60% 
## -3.77626950 -1.54515575 -0.79499900 -0.36749059 -0.03279709  0.31130884 
##         70%         80%         90% 
##  0.70619733  1.32531475  3.05080000</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">print</span>(theoretical_deciles)</span></code></pre></div>
<pre><code>## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197  0.7265425
## [8]  1.3763819  3.0776835</code></pre>
</div>
<div id="section-5" class="section level2">
<h2>9.8</h2>
<p>This example appears in [40]. Consider the bivariate density</p>
<span class="math display">\[\begin{equation*}
f(x, y) \propto\binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1,
\ldots, n, 0 \leq y \leq 1
\end{equation*}\]</span>
<p>It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span>
and <span class="math inline">\(\operatorname{Beta}(x+a,
n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target
joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="co"># Gibbs sampler for the bivariate density</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>gibbs_sampler_bivariate <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b) {</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>  <span class="co"># Initial values</span></span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>  x_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, <span class="fl">0.5</span>)  <span class="co"># Initial value for x</span></span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>  y_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)            <span class="co"># Initial value for y</span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>    <span class="co"># Sample from the conditional distributions</span></span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>    x_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y_samples[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>    y_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x_samples[i] <span class="sc">+</span> a, n <span class="sc">-</span> x_samples[i] <span class="sc">+</span> b)</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>  }</span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x_samples, <span class="at">y =</span> y_samples))</span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>}</span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a></span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a><span class="co"># Run multiple chains for convergence check</span></span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a>n_samples_gibbs <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a>chains_gibbs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>num_chains, <span class="cf">function</span>(i) <span class="fu">gibbs_sampler_bivariate</span>(n_samples_gibbs, a, b))</span>
<span id="cb78-26"><a href="#cb78-26" tabindex="-1"></a></span>
<span id="cb78-27"><a href="#cb78-27" tabindex="-1"></a><span class="co"># Check convergence using Gelman-Rubin statistic</span></span>
<span id="cb78-28"><a href="#cb78-28" tabindex="-1"></a>R_gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb78-29"><a href="#cb78-29" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(chains)  <span class="co"># Number of chains</span></span>
<span id="cb78-30"><a href="#cb78-30" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, length)  <span class="co"># Length of each chain</span></span>
<span id="cb78-31"><a href="#cb78-31" tabindex="-1"></a>  theta_hat <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, mean)  <span class="co"># Mean of each chain</span></span>
<span id="cb78-32"><a href="#cb78-32" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">var</span>(theta_hat) <span class="sc">*</span> n[<span class="dv">1</span>] <span class="sc">/</span> (m <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># Between-chain variance</span></span>
<span id="cb78-33"><a href="#cb78-33" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sapply</span>(chains, var))  <span class="co"># Within-chain variance</span></span>
<span id="cb78-34"><a href="#cb78-34" tabindex="-1"></a>  var_theta_hat <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> m) <span class="sc">*</span> W <span class="sc">+</span> B <span class="sc">/</span> m  <span class="co"># Total variance estimate</span></span>
<span id="cb78-35"><a href="#cb78-35" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(var_theta_hat <span class="sc">/</span> W))  <span class="co"># Gelman-Rubin statistic</span></span>
<span id="cb78-36"><a href="#cb78-36" tabindex="-1"></a>}</span>
<span id="cb78-37"><a href="#cb78-37" tabindex="-1"></a></span>
<span id="cb78-38"><a href="#cb78-38" tabindex="-1"></a><span class="co"># Run until convergence</span></span>
<span id="cb78-39"><a href="#cb78-39" tabindex="-1"></a>R_x_value <span class="ot">&lt;-</span> <span class="fu">R_gibbs</span>(<span class="fu">lapply</span>(chains_gibbs, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;x&quot;</span>))</span>
<span id="cb78-40"><a href="#cb78-40" tabindex="-1"></a>R_y_value <span class="ot">&lt;-</span> <span class="fu">R_gibbs</span>(<span class="fu">lapply</span>(chains_gibbs, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;y&quot;</span>))</span>
<span id="cb78-41"><a href="#cb78-41" tabindex="-1"></a></span>
<span id="cb78-42"><a href="#cb78-42" tabindex="-1"></a>timer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb78-43"><a href="#cb78-43" tabindex="-1"></a><span class="cf">while</span> (R_x_value <span class="sc">&gt;=</span> <span class="fl">1.2</span> <span class="sc">||</span> R_y_value <span class="sc">&gt;=</span> <span class="fl">1.2</span>) {</span>
<span id="cb78-44"><a href="#cb78-44" tabindex="-1"></a>  timer <span class="ot">&lt;-</span> timer <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb78-45"><a href="#cb78-45" tabindex="-1"></a>  chains_gibbs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>num_chains, <span class="cf">function</span>(i) <span class="fu">gibbs_sampler_bivariate</span>(n_samples_gibbs, a, b))</span>
<span id="cb78-46"><a href="#cb78-46" tabindex="-1"></a>  R_x_value <span class="ot">&lt;-</span> <span class="fu">R_gibbs</span>(<span class="fu">lapply</span>(chains_gibbs, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;x&quot;</span>))</span>
<span id="cb78-47"><a href="#cb78-47" tabindex="-1"></a>  R_y_value <span class="ot">&lt;-</span> <span class="fu">R_gibbs</span>(<span class="fu">lapply</span>(chains_gibbs, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;y&quot;</span>))</span>
<span id="cb78-48"><a href="#cb78-48" tabindex="-1"></a>  <span class="cf">if</span>(timer <span class="sc">&gt;=</span> <span class="dv">100</span>) <span class="cf">break</span></span>
<span id="cb78-49"><a href="#cb78-49" tabindex="-1"></a>}</span>
<span id="cb78-50"><a href="#cb78-50" tabindex="-1"></a><span class="fu">plot</span>(chains_gibbs[[num_chains]]<span class="sc">$</span>x,chains_gibbs[[num_chains]]<span class="sc">$</span>y)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="section-6" class="section level2">
<h2>11.3</h2>
<ol style="list-style-type: lower-alpha">
<li>Write a function to compute the <span class="math inline">\(k^{t
h}\)</span> term in</li>
</ol>
<p><span class="math display">\[\begin{equation*}
\sum_{k=0}^{\infty} \frac{(-1)^k}{k!2^k} \frac{\|a\|^{2 k+2}}{(2 k+1)(2
k+2)} \frac{\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)},
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(d \geq 1\)</span> is an integer,
<span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm.
Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large <span class="math inline">\(k\)</span> and
<span class="math inline">\(d\)</span>. (This sum converges for all
<span class="math inline">\(a \in \mathbb{R}^d\)</span> ).</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, d, a) {</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  </span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>  gamma_d_half <span class="ot">&lt;-</span> <span class="fu">lgamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>  gamma_k_3_half <span class="ot">&lt;-</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="fl">1.5</span>)</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>  gamma_k_d_half_plus_1 <span class="ot">&lt;-</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> (d <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>  </span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>  coefficient <span class="ot">&lt;-</span> ((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k) <span class="sc">/</span> (<span class="fu">factorial</span>(k) <span class="sc">*</span> (<span class="dv">2</span><span class="sc">^</span>k))</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>  power_term <span class="ot">&lt;-</span> (norm_a<span class="sc">^</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>)) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>  </span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>  gamma_ratio_log <span class="ot">&lt;-</span> gamma_d_half <span class="sc">+</span> gamma_k_3_half <span class="sc">-</span> gamma_k_d_half_plus_1</span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>  </span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a>  term <span class="ot">&lt;-</span> coefficient <span class="sc">*</span> power_term <span class="sc">*</span> <span class="fu">exp</span>(gamma_ratio_log)</span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a>  <span class="fu">return</span>(term)</span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Modify the function so that it computes and returns the sum.</li>
</ol>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>sum_series <span class="ot">&lt;-</span> <span class="cf">function</span>(d, a, <span class="at">tol =</span> <span class="fl">1e-5</span>, <span class="at">max_k =</span> <span class="dv">100</span>) {</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  term <span class="ot">&lt;-</span> <span class="fu">kth_term</span>(k, d, a)</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>  </span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(term) <span class="sc">&gt;</span> tol <span class="sc">&amp;&amp;</span> k <span class="sc">&lt;</span> max_k) {</span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>    sum <span class="ot">&lt;-</span> sum <span class="sc">+</span> term</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">kth_term</span>(k, d, a)</span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>  }</span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>  </span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>  <span class="fu">return</span>(sum)</span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Evaluate the sum when <span class="math inline">\(a=(1,2)^T\)</span>.</li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">sum_series</span>(d, a)</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## [1] 0.03133207</code></pre>
</div>
<div id="section-7" class="section level2">
<h2>11.5</h2>
<p>Write a function to solve the equation</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
&amp; \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)
\Gamma\left(\frac{k-1}{2}\right)}}
\int_0^{c_{k-1}}\left(1+\frac{u^2}{k-1}\right)^{-k / 2} d u \\
&amp; \quad=\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}
\Gamma\left(\frac{k}{2}\right)}
\int_0^{c_k}\left(1+\frac{u^2}{k}\right)^{-(k+1) / 2} d u
\end{aligned}
\end{equation*}\]</span></p>
<p>for <span class="math inline">\(a\)</span>, where</p>
<p><span class="math display">\[\begin{equation*}
c_k=\sqrt{\frac{a^2 k}{k+1-a^2}} .
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">library</span>(gmp)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gmp&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     %*%, apply, crossprod, matrix, tcrossprod</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>integral <span class="ot">&lt;-</span> <span class="cf">function</span>(c, k) {</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>  integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u) {</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k) <span class="sc">^</span> (<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>  }</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">integrate</span>(integrand, <span class="dv">0</span>, c)<span class="sc">$</span>value)</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>}</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>equation <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>  c_k <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>  c_k_minus_1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>  </span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>  lhs <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>))) <span class="sc">*</span> <span class="fu">integral</span>(c_k_minus_1, k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>  </span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>  rhs <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> k) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>))) <span class="sc">*</span> <span class="fu">integral</span>(c_k, k)</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>  </span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>  <span class="fu">return</span>(lhs <span class="sc">-</span> rhs)</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a>}</span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a></span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a>solve_for_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(equation, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">1.5</span>), <span class="at">k =</span> k)</span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>  <span class="fu">return</span>(result<span class="sc">$</span>root)</span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a>}</span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a></span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>a_solution <span class="ot">&lt;-</span> <span class="fu">solve_for_a</span>(k)</span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Solution for a when k =&quot;</span>, k, <span class="st">&quot;is a =&quot;</span>, a_solution))</span></code></pre></div>
<pre><code>## [1] &quot;Solution for a when k = 3 is a = 1.42822579204349&quot;</code></pre>
</div>
<div id="练习" class="section level2">
<h2>练习</h2>
<p>Suppose <span class="math inline">\(T_1, \ldots, T_n\)</span> are
i.i.d. samples drawn from the exponential distribution with expectation
<span class="math inline">\(\lambda\)</span>. Those values greater than
<span class="math inline">\(\tau\)</span> are not observed due to right
censorship, so that the observed values are <span class="math inline">\(Y_i=T_i l\left(T_i \leq \tau\right)+\tau
l\left(T_i&gt;\tau\right)\)</span>, <span class="math inline">\(i=1,
\ldots, n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span>
and the observed <span class="math inline">\(Y_i\)</span> values are as
follows:</p>
<p><span class="math display">\[\begin{equation*}
0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\end{equation*}\]</span></p>
<p>Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the
observed data MLE (note: <span class="math inline">\(Y_i\)</span>
follows a mixture distribution).</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y <span class="sc">&lt;</span> tau, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y) </span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>tolerance <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>max_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>diff <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a><span class="co"># E-M algorithm</span></span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a><span class="cf">while</span> (diff <span class="sc">&gt;</span> tolerance <span class="sc">&amp;&amp;</span> iter <span class="sc">&lt;</span> max_iter) {</span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>  lambda_old <span class="ot">&lt;-</span> lambda</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a>  </span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>  T_imputed <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(delta <span class="sc">==</span> <span class="dv">1</span>, Y, tau <span class="sc">+</span> lambda)</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a>  </span>
<span id="cb88-19"><a href="#cb88-19" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">mean</span>(T_imputed)</span>
<span id="cb88-20"><a href="#cb88-20" tabindex="-1"></a></span>
<span id="cb88-21"><a href="#cb88-21" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(lambda <span class="sc">-</span> lambda_old)</span>
<span id="cb88-22"><a href="#cb88-22" tabindex="-1"></a>}</span>
<span id="cb88-23"><a href="#cb88-23" tabindex="-1"></a></span>
<span id="cb88-24"><a href="#cb88-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated lambda using E-M algorithm:&quot;</span>, lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated lambda using E-M algorithm: 0.9642856</code></pre>
<p><span class="math inline">\(T_i \sim
\text{Exp}(\lambda)\)</span>，即每个 <span class="math inline">\(T_i\)</span> 的概率密度函数为： <span class="math display">\[
f(t \mid \lambda) = \frac{1}{\lambda} e^{-t / \lambda}, \quad t \geq 0.
\]</span></p>
<p>由于右截尾，我们观察到的数据 <span class="math inline">\(Y_i\)</span>
为： <span class="math display">\[
Y_i = \begin{cases}
T_i &amp; \text{if } T_i \leq \tau \\
\tau &amp; \text{if } T_i &gt; \tau.
\end{cases}
\]</span></p>
<p>定义指示变量 <span class="math inline">\(\delta_i\)</span>： <span class="math display">\[
\delta_i = \begin{cases}
1 &amp; \text{if } T_i \leq \tau \\
0 &amp; \text{if } T_i &gt; \tau.
\end{cases}
\]</span></p>
<p>因此，对于观测数据 <span class="math inline">\(Y_i\)</span>，对数似然函数为： <span class="math display">\[
\ell(\lambda) = \sum_{i=1}^n \delta_i \left( -\log(\lambda) -
\frac{Y_i}{\lambda} \right) + \sum_{i=1}^n (1 - \delta_i) \left(
-\frac{\tau}{\lambda} \right).
\]</span></p>
<p>令 <span class="math inline">\(n_1 = \sum_{i=1}^n \delta_i\)</span>
表示未截尾的样本数，且 <span class="math inline">\(S = \sum_{i=1}^n
\delta_i Y_i + \sum_{i=1}^n (1 - \delta_i) \tau\)</span>
表示观测到的数据之和。对数似然函数变为： <span class="math display">\[
\ell(\lambda) = -n_1 \log(\lambda) - \frac{S}{\lambda}.
\]</span></p>
<p>令</p>
<p><span class="math display">\[
\frac{d\ell}{d\lambda} = -\frac{n_1}{\lambda} + \frac{S}{\lambda^2} = 0.
\]</span></p>
<p>解出 <span class="math inline">\(\lambda\)</span> 得到最大似然估计：
<span class="math display">\[
\hat{\lambda} = \frac{S}{n_1}.
\]</span></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y <span class="sc">&lt;</span> tau, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(delta)</span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">sum</span>(delta <span class="sc">*</span> Y <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> delta) <span class="sc">*</span> tau)</span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> S <span class="sc">/</span> n1</span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated lambda (MLE) considering censoring:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated lambda (MLE) considering censoring: 0.9642857</code></pre>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="ex11.7-statistical-computing-with-r" class="section level2">
<h2>Ex11.7 (Statistical Computing with R)</h2>
<p>Use the simplex algorithm to solve the following problem. Minimize
<span class="math inline">\(4x+2y+9z\)</span> subject to</p>
<p><span class="math display">\[\begin{aligned}&amp;2x+y+z\leq2\\&amp;x-y+3z\leq3\\&amp;x\geq0,\:y\geq0,\:z\geq0.\end{aligned}\]</span></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a>initialize_tableau <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>,   </span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>    <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>,  </span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">9</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>  ), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a>}</span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a>simplex_pivot <span class="ot">&lt;-</span> <span class="cf">function</span>(tableau, pivot_row, pivot_col) {</span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a>  tableau[pivot_row, ] <span class="ot">&lt;-</span> tableau[pivot_row, ] <span class="sc">/</span> tableau[pivot_row, pivot_col]</span>
<span id="cb92-13"><a href="#cb92-13" tabindex="-1"></a></span>
<span id="cb92-14"><a href="#cb92-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(tableau))) {</span>
<span id="cb92-15"><a href="#cb92-15" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">!=</span> pivot_row) {</span>
<span id="cb92-16"><a href="#cb92-16" tabindex="-1"></a>      tableau[i, ] <span class="ot">&lt;-</span> tableau[i, ] <span class="sc">-</span> tableau[i, pivot_col] <span class="sc">*</span> tableau[pivot_row, ]</span>
<span id="cb92-17"><a href="#cb92-17" tabindex="-1"></a>    }</span>
<span id="cb92-18"><a href="#cb92-18" tabindex="-1"></a>  }</span>
<span id="cb92-19"><a href="#cb92-19" tabindex="-1"></a>  <span class="fu">return</span>(tableau)</span>
<span id="cb92-20"><a href="#cb92-20" tabindex="-1"></a>}</span>
<span id="cb92-21"><a href="#cb92-21" tabindex="-1"></a></span>
<span id="cb92-22"><a href="#cb92-22" tabindex="-1"></a></span>
<span id="cb92-23"><a href="#cb92-23" tabindex="-1"></a>is_optimal <span class="ot">&lt;-</span> <span class="cf">function</span>(tableau) {</span>
<span id="cb92-24"><a href="#cb92-24" tabindex="-1"></a>  <span class="fu">all</span>(tableau[<span class="fu">nrow</span>(tableau), <span class="sc">-</span><span class="fu">ncol</span>(tableau)] <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb92-25"><a href="#cb92-25" tabindex="-1"></a>}</span>
<span id="cb92-26"><a href="#cb92-26" tabindex="-1"></a></span>
<span id="cb92-27"><a href="#cb92-27" tabindex="-1"></a></span>
<span id="cb92-28"><a href="#cb92-28" tabindex="-1"></a>get_pivot <span class="ot">&lt;-</span> <span class="cf">function</span>(tableau) {</span>
<span id="cb92-29"><a href="#cb92-29" tabindex="-1"></a></span>
<span id="cb92-30"><a href="#cb92-30" tabindex="-1"></a>  pivot_col <span class="ot">&lt;-</span> <span class="fu">which.min</span>(tableau[<span class="fu">nrow</span>(tableau), <span class="sc">-</span><span class="fu">ncol</span>(tableau)])</span>
<span id="cb92-31"><a href="#cb92-31" tabindex="-1"></a>  </span>
<span id="cb92-32"><a href="#cb92-32" tabindex="-1"></a></span>
<span id="cb92-33"><a href="#cb92-33" tabindex="-1"></a>  ratios <span class="ot">&lt;-</span> tableau[<span class="sc">-</span><span class="fu">nrow</span>(tableau), <span class="fu">ncol</span>(tableau)] <span class="sc">/</span> tableau[<span class="sc">-</span><span class="fu">nrow</span>(tableau), pivot_col]</span>
<span id="cb92-34"><a href="#cb92-34" tabindex="-1"></a>  ratios[ratios <span class="sc">&lt;=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">Inf</span> </span>
<span id="cb92-35"><a href="#cb92-35" tabindex="-1"></a>  pivot_row <span class="ot">&lt;-</span> <span class="fu">which.min</span>(ratios)</span>
<span id="cb92-36"><a href="#cb92-36" tabindex="-1"></a>  </span>
<span id="cb92-37"><a href="#cb92-37" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">pivot_row =</span> pivot_row, <span class="at">pivot_col =</span> pivot_col))</span>
<span id="cb92-38"><a href="#cb92-38" tabindex="-1"></a>}</span>
<span id="cb92-39"><a href="#cb92-39" tabindex="-1"></a></span>
<span id="cb92-40"><a href="#cb92-40" tabindex="-1"></a>simplex <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb92-41"><a href="#cb92-41" tabindex="-1"></a>  tableau <span class="ot">&lt;-</span> <span class="fu">initialize_tableau</span>()</span>
<span id="cb92-42"><a href="#cb92-42" tabindex="-1"></a>  </span>
<span id="cb92-43"><a href="#cb92-43" tabindex="-1"></a>  <span class="cf">while</span> (<span class="sc">!</span><span class="fu">is_optimal</span>(tableau)) {</span>
<span id="cb92-44"><a href="#cb92-44" tabindex="-1"></a>    pivot <span class="ot">&lt;-</span> <span class="fu">get_pivot</span>(tableau)</span>
<span id="cb92-45"><a href="#cb92-45" tabindex="-1"></a>    tableau <span class="ot">&lt;-</span> <span class="fu">simplex_pivot</span>(tableau, pivot<span class="sc">$</span>pivot_row, pivot<span class="sc">$</span>pivot_col)</span>
<span id="cb92-46"><a href="#cb92-46" tabindex="-1"></a>  }</span>
<span id="cb92-47"><a href="#cb92-47" tabindex="-1"></a>  </span>
<span id="cb92-48"><a href="#cb92-48" tabindex="-1"></a>  </span>
<span id="cb92-49"><a href="#cb92-49" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(tableau) <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># 初始化解</span></span>
<span id="cb92-50"><a href="#cb92-50" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(tableau) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb92-51"><a href="#cb92-51" tabindex="-1"></a>    basic_var_index <span class="ot">&lt;-</span> <span class="fu">which</span>(tableau[i, <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(tableau) <span class="sc">-</span> <span class="dv">1</span>)] <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb92-52"><a href="#cb92-52" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(basic_var_index) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb92-53"><a href="#cb92-53" tabindex="-1"></a>      solution[basic_var_index] <span class="ot">&lt;-</span> tableau[i, <span class="fu">ncol</span>(tableau)]</span>
<span id="cb92-54"><a href="#cb92-54" tabindex="-1"></a>    }</span>
<span id="cb92-55"><a href="#cb92-55" tabindex="-1"></a>  }</span>
<span id="cb92-56"><a href="#cb92-56" tabindex="-1"></a>  </span>
<span id="cb92-57"><a href="#cb92-57" tabindex="-1"></a>  objective_value <span class="ot">&lt;-</span> tableau[<span class="fu">nrow</span>(tableau), <span class="fu">ncol</span>(tableau)] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>  <span class="co"># 原问题是最小化</span></span>
<span id="cb92-58"><a href="#cb92-58" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">solution =</span> solution, <span class="at">objective_value =</span> objective_value)</span>
<span id="cb92-59"><a href="#cb92-59" tabindex="-1"></a>}</span>
<span id="cb92-60"><a href="#cb92-60" tabindex="-1"></a></span>
<span id="cb92-61"><a href="#cb92-61" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">simplex</span>()</span>
<span id="cb92-62"><a href="#cb92-62" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;最优解:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 最优解:</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>solution)</span></code></pre></div>
<pre><code>## [1] 0.00 0.75 1.25 0.00 0.00</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;最小目标值:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 最小目标值:</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>objective_value)</span></code></pre></div>
<pre><code>## [1] -12.75</code></pre>
</div>
<div id="ex3-p204-advanced-r" class="section level2">
<h2>Ex3 (p204, Advanced R)</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars
using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a>)</span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a>models_for <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a>  models_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a>}</span>
<span id="cb100-14"><a href="#cb100-14" tabindex="-1"></a></span>
<span id="cb100-15"><a href="#cb100-15" tabindex="-1"></a></span>
<span id="cb100-16"><a href="#cb100-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Models fitted using for loop:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Models fitted using for loop:</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">print</span>(models_for)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>models_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(formula) <span class="fu">lm</span>(formula, <span class="at">data =</span> mtcars))</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Models fitted using lapply():</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Models fitted using lapply():</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">print</span>(models_lapply)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="ex4-p204-advanced-r" class="section level2">
<h2>Ex4 (p204, Advanced R)</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply(). Can you do it
without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) {</p>
<p>rows &lt;- sample(1:nrow(mtcars), rep = TRUE)</p>
<p>mtcars[rows, ]</p>
<p>})</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)  </span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>})</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>models_for1 <span class="ot">&lt;-</span> <span class="fu">list</span>()  </span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a>  models_for1[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>}</span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a></span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Models fitted using for loop:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Models fitted using for loop:</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">print</span>(models_for1)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.66841     -0.03051  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.19074     -0.04154  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.40014     -0.04445  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.44286     -0.04566  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.34661     -0.04429  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.72026     -0.04563  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.57421     -0.04612  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.60093     -0.03704  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.50750     -0.03559  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.64187     -0.03027</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)  <span class="co"># Define a named function</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>models_lapply1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, fit_model)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Models fitted using lapply():</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Models fitted using lapply():</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">print</span>(models_lapply1)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    26.66841     -0.03051  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.19074     -0.04154  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.40014     -0.04445  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.44286     -0.04566  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.34661     -0.04429  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    31.72026     -0.04563  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.57421     -0.04612  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.60093     -0.03704  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.50750     -0.03559  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.64187     -0.03027</code></pre>
</div>
<div id="ex5-p204-advanced-r" class="section level2">
<h2>Ex5 (p204, Advanced R)</h2>
<p>For each model in the previous two exercises, extract R^2 using the
function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a><span class="fu">sapply</span>(models_for, rsq)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">sapply</span>(models_lapply, rsq)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">sapply</span>(models_for1, rsq)</span></code></pre></div>
<pre><code>##  [1] 0.5570039 0.6558963 0.7000628 0.7995445 0.8215032 0.7983167 0.8143575
##  [8] 0.6779900 0.6243300 0.6179178</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="fu">sapply</span>(models_lapply1, rsq)</span></code></pre></div>
<pre><code>##  [1] 0.5570039 0.6558963 0.7000628 0.7995445 0.8215032 0.7983167 0.8143575
##  [8] 0.6779900 0.6243300 0.6179178</code></pre>
<p><br />
</p>
</div>
<div id="ex3-p213-advanced-r" class="section level2">
<h2>Ex3 (p213, Advanced R)</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
<p>trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)),
simplify = FALSE )</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb124-4"><a href="#cb124-4" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb124-5"><a href="#cb124-5" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb124-6"><a href="#cb124-6" tabindex="-1"></a>)</span>
<span id="cb124-7"><a href="#cb124-7" tabindex="-1"></a></span>
<span id="cb124-8"><a href="#cb124-8" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="cf">function</span>(test) test<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.027244088 0.970264651 0.841614412 0.843607534 0.059771356 0.722565615
##   [7] 0.683770819 0.039356387 0.571554185 0.289565805 0.611798048 0.203644404
##  [13] 0.054600483 0.904607967 0.911841272 0.351889669 0.353569835 0.272205552
##  [19] 0.757591119 0.791269351 0.114922202 0.993893302 0.296951195 0.320241743
##  [25] 0.762052132 0.972673027 0.868058892 0.319256648 0.005775194 0.145719710
##  [31] 0.747811983 0.870617757 0.366735265 0.611954997 0.807865913 0.097214871
##  [37] 0.021657065 0.132021699 0.867490265 0.814267631 0.979102573 0.823335779
##  [43] 0.342437781 0.284830597 0.945349534 0.626075852 0.330823784 0.775045162
##  [49] 0.753765324 0.974309768 0.878214260 0.579870246 0.236994834 0.254781526
##  [55] 0.912569430 0.456450307 0.971808406 0.349497761 0.317251742 0.501850909
##  [61] 0.982182468 0.674102099 0.172421678 0.056164440 0.439805001 0.239097048
##  [67] 0.272963057 0.613416546 0.908244699 0.030085567 0.768092643 0.271132464
##  [73] 0.786240282 0.597826382 0.288313418 0.387335398 0.879953357 0.598278028
##  [79] 0.782806088 0.957829375 0.248056399 0.080852294 0.142817718 0.050115673
##  [85] 0.347015979 0.532744893 0.841528996 0.808712238 0.502939014 0.384968428
##  [91] 0.858258529 0.418853293 0.671383188 0.581131788 0.076598832 0.885933508
##  [97] 0.905180521 0.006526158 0.068241877 0.502265782</code></pre>
</div>
<div id="ex6-p214-advanced-r" class="section level2">
<h2>Ex6 (p214, Advanced R)</h2>
<p>Implement a combination of Map() and vapply() to create an lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What arguments should the function
take?</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>parallel_apply <span class="ot">&lt;-</span> <span class="cf">function</span>(fun, ..., FUN.VALUE) {</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>  inputs <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">Map</span>(fun, inputs[[<span class="dv">1</span>]], inputs[[<span class="dv">2</span>]])</span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>  <span class="fu">vapply</span>(results, identity, <span class="at">FUN.VALUE =</span> FUN.VALUE)</span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>}</span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a></span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a><span class="co">#Example</span></span>
<span id="cb126-8"><a href="#cb126-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb126-9"><a href="#cb126-9" tabindex="-1"></a>list1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb126-10"><a href="#cb126-10" tabindex="-1"></a>list2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb126-11"><a href="#cb126-11" tabindex="-1"></a></span>
<span id="cb126-12"><a href="#cb126-12" tabindex="-1"></a>sum_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) x <span class="sc">+</span> y</span>
<span id="cb126-13"><a href="#cb126-13" tabindex="-1"></a></span>
<span id="cb126-14"><a href="#cb126-14" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">parallel_apply</span>(sum_fun, list1, list2, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb126-15"><a href="#cb126-15" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1]  3  6  9 12 15</code></pre>
</div>
<div id="ex4-p365-advanced-r" class="section level2">
<h2>Ex4 (p365, Advanced R)</h2>
<p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition (<a href="http://en." class="uri">http://en.</a>wikipedia.org/wiki/Pearson%27s_chi-squared_test).</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>  </span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>  </span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>  row_totals <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(observed, <span class="dv">1</span>)</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>  col_totals <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(observed, <span class="dv">2</span>)</span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>  grand_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a>  </span>
<span id="cb128-9"><a href="#cb128-9" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_totals, col_totals, <span class="at">FUN =</span> <span class="st">&quot;*&quot;</span>) <span class="sc">/</span> grand_total</span>
<span id="cb128-10"><a href="#cb128-10" tabindex="-1"></a>  chi_square_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb128-11"><a href="#cb128-11" tabindex="-1"></a>  <span class="fu">return</span>(chi_square_stat)</span>
<span id="cb128-12"><a href="#cb128-12" tabindex="-1"></a>}</span>
<span id="cb128-13"><a href="#cb128-13" tabindex="-1"></a></span>
<span id="cb128-14"><a href="#cb128-14" tabindex="-1"></a><span class="co"># test</span></span>
<span id="cb128-15"><a href="#cb128-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb128-16"><a href="#cb128-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fl">1e6</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-17"><a href="#cb128-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fl">1e6</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-18"><a href="#cb128-18" tabindex="-1"></a></span>
<span id="cb128-19"><a href="#cb128-19" tabindex="-1"></a>fast_chisq_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb128-20"><a href="#cb128-20" tabindex="-1"></a>  result_fast <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb128-21"><a href="#cb128-21" tabindex="-1"></a>})</span>
<span id="cb128-22"><a href="#cb128-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;fast_chisq_test 执行时间: &quot;</span>, fast_chisq_time[<span class="dv">3</span>], <span class="st">&quot;秒</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## fast_chisq_test 执行时间:  0.16 秒</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>chisq_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>  result_chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(x, y)</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>})</span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;chisq.test 执行时间: &quot;</span>, chisq_time[<span class="dv">3</span>], <span class="st">&quot;秒</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## chisq.test 执行时间:  0.18 秒</code></pre>
</div>
<div id="ex5-p365-advanced-r" class="section level2">
<h2>Ex5 (p365, Advanced R)</h2>
<p>Can you make a faster version of table() for the case of an input of
two integer vectors with no missing values? Can you use it to speed up
your chi-square test?</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a>  ux <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x)) </span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a>  uy <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(y), <span class="fu">max</span>(y))</span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>  </span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a>  xi <span class="ot">&lt;-</span> <span class="fu">match</span>(x, ux)</span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a>  yi <span class="ot">&lt;-</span> <span class="fu">match</span>(y, uy)</span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a>  </span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span><span class="dt">L</span>, <span class="at">nrow =</span> <span class="fu">length</span>(ux), <span class="at">ncol =</span> <span class="fu">length</span>(uy))</span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a>  index <span class="ot">&lt;-</span> (xi <span class="sc">-</span> <span class="dv">1</span><span class="dt">L</span>) <span class="sc">*</span> <span class="fu">length</span>(uy) <span class="sc">+</span> yi</span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(index, <span class="at">nbins =</span> <span class="fu">length</span>(ux) <span class="sc">*</span> <span class="fu">length</span>(uy))</span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a>  result[] <span class="ot">&lt;-</span> counts</span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a>  <span class="fu">dimnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">as.character</span>(ux), <span class="fu">as.character</span>(uy))</span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a>}</span>
<span id="cb132-16"><a href="#cb132-16" tabindex="-1"></a></span>
<span id="cb132-17"><a href="#cb132-17" tabindex="-1"></a></span>
<span id="cb132-18"><a href="#cb132-18" tabindex="-1"></a></span>
<span id="cb132-19"><a href="#cb132-19" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fl">1e6</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-20"><a href="#cb132-20" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fl">1e6</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-21"><a href="#cb132-21" tabindex="-1"></a>fast_table_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb132-22"><a href="#cb132-22" tabindex="-1"></a>  result_fast <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb132-23"><a href="#cb132-23" tabindex="-1"></a>})</span>
<span id="cb132-24"><a href="#cb132-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;fast_table 执行时间: &quot;</span>, fast_table_time[<span class="dv">3</span>], <span class="st">&quot;秒</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## fast_table 执行时间:  0.03 秒</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>table_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>  result_table <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a>})</span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;table 执行时间: &quot;</span>, table_time[<span class="dv">3</span>], <span class="st">&quot;秒</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## table 执行时间:  0.12 秒</code></pre>
<div id="改进chisq.test" class="section level3">
<h3>改进chisq.test</h3>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>  </span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>  </span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>  row_totals <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(observed, <span class="dv">1</span>)</span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>  col_totals <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(observed, <span class="dv">2</span>)</span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a>  grand_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>  </span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_totals, col_totals, <span class="at">FUN =</span> <span class="st">&quot;*&quot;</span>) <span class="sc">/</span> grand_total</span>
<span id="cb136-10"><a href="#cb136-10" tabindex="-1"></a>  chi_square_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb136-11"><a href="#cb136-11" tabindex="-1"></a>  <span class="fu">return</span>(chi_square_stat)</span>
<span id="cb136-12"><a href="#cb136-12" tabindex="-1"></a>}</span>
<span id="cb136-13"><a href="#cb136-13" tabindex="-1"></a></span>
<span id="cb136-14"><a href="#cb136-14" tabindex="-1"></a><span class="co"># test</span></span>
<span id="cb136-15"><a href="#cb136-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb136-16"><a href="#cb136-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fl">1e6</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb136-17"><a href="#cb136-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fl">1e6</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb136-18"><a href="#cb136-18" tabindex="-1"></a></span>
<span id="cb136-19"><a href="#cb136-19" tabindex="-1"></a>fast_chisq_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb136-20"><a href="#cb136-20" tabindex="-1"></a>  result_fast <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb136-21"><a href="#cb136-21" tabindex="-1"></a>})</span>
<span id="cb136-22"><a href="#cb136-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;fast_chisq_test 执行时间: &quot;</span>, fast_chisq_time[<span class="dv">3</span>], <span class="st">&quot;秒</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## fast_chisq_test 执行时间:  0.01 秒</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>chisq_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a>  result_chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(x, y)</span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>})</span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;chisq.test 执行时间: &quot;</span>, chisq_time[<span class="dv">3</span>], <span class="st">&quot;秒</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## chisq.test 执行时间:  0.14 秒</code></pre>
</div>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="ex-9.8" class="section level2">
<h2>Ex 9.8</h2>
<p>This example appears in [40]. Consider the bivariate density</p>
<p><span class="math display">\[\begin{equation*}
f(x, y) \propto\binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1,
\ldots, n, 0 \leq y \leq 1
\end{equation*}\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span>
and <span class="math inline">\(\operatorname{Beta}(x+a,
n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target
joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<ul>
<li><p>Write an Rcpp function for Exercise 9.8</p></li>
<li><p>Compare the corresponding generated random numbers with those by
the R function you wrote using the function “qqplot”.</p></li>
<li><p>Compare the computation time of the two functions with the
function “microbenchmark”.</p></li>
<li><p>Comments your results</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="co"># R-function</span></span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a>gibbs_sampler_r <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, num_iter, <span class="at">n_init =</span> <span class="dv">0</span>) {</span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a>  x_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iter)</span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a>  y_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iter)</span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> n_init</span>
<span id="cb140-7"><a href="#cb140-7" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb140-8"><a href="#cb140-8" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_iter) {</span>
<span id="cb140-10"><a href="#cb140-10" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb140-11"><a href="#cb140-11" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb140-12"><a href="#cb140-12" tabindex="-1"></a></span>
<span id="cb140-13"><a href="#cb140-13" tabindex="-1"></a>    x_chain[i] <span class="ot">&lt;-</span> x</span>
<span id="cb140-14"><a href="#cb140-14" tabindex="-1"></a>    y_chain[i] <span class="ot">&lt;-</span> y</span>
<span id="cb140-15"><a href="#cb140-15" tabindex="-1"></a>  }</span>
<span id="cb140-16"><a href="#cb140-16" tabindex="-1"></a></span>
<span id="cb140-17"><a href="#cb140-17" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">x =</span> x_chain, <span class="at">y =</span> y_chain)</span>
<span id="cb140-18"><a href="#cb140-18" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="comparing-by-qq-plot">Comparing by QQ-plot</h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&quot;gibbs_sampler.cpp&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork):
## path[1]=&quot;C:/Users/zcx/AppData/Local/R/win-library/4.4/SA24204169/vignettes/../inst/include&quot;:
## 系统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb143-3"><a href="#cb143-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb143-4"><a href="#cb143-4" tabindex="-1"></a>num_iter <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb143-5"><a href="#cb143-5" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb143-7"><a href="#cb143-7" tabindex="-1"></a>result_rcpp <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler_rcpp</span>(n, a, b, num_iter)</span>
<span id="cb143-8"><a href="#cb143-8" tabindex="-1"></a>result_r <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler_r</span>(n, a, b, num_iter)</span>
<span id="cb143-9"><a href="#cb143-9" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" tabindex="-1"></a><span class="co"># QQ Plot comparison for x and y</span></span>
<span id="cb143-11"><a href="#cb143-11" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb143-12"><a href="#cb143-12" tabindex="-1"></a><span class="fu">qqplot</span>(result_rcpp<span class="sc">$</span>x, result_r<span class="sc">$</span>x, <span class="at">main =</span> <span class="st">&quot;QQ Plot for x&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Rcpp x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R x&quot;</span>)</span>
<span id="cb143-13"><a href="#cb143-13" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb143-14"><a href="#cb143-14" tabindex="-1"></a></span>
<span id="cb143-15"><a href="#cb143-15" tabindex="-1"></a><span class="fu">qqplot</span>(result_rcpp<span class="sc">$</span>y, result_r<span class="sc">$</span>y, <span class="at">main =</span> <span class="st">&quot;QQ Plot for y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Rcpp y&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R y&quot;</span>)</span>
<span id="cb143-16"><a href="#cb143-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAACsAAFUAKysAK1UAK4AAVaorAAArACsrKysrK1UrK4ArVYArVaorgKorgNRVAABVACtVKwBVKytVK4BVVStVVVVVgFVVgIBVgKpVgNRVqtRVqv+AKwCAK1WAqoCA1KqA1P+qVQCqVSuqVYCq1P+q/6qq///UgCvUgIDUqoDU1KrU1NTU1P/U/9TU////AAD/qlX/1ID/1Kr//6r//9T////LdE0MAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKzUlEQVR4nO2diZrbthWFIace2U1TK+7ejJparhs2XSzJI73/oxULdwI6lyJAwNE5yTcjDjnA8U8AFwQxgLpSN6VyGyhdBAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAQkAXT5+XdKqbc/fPYealXK6def9Nm9ev159Pv/+Kn59HGr1HdLPa/qRwDo5X2d368+eQ77htTmg8fQl/evGkMnc9E7nGVBfjAgnUMjk/DocGhIe5kaOvQv1JYXamU/GJDObWOK789bC3t0WF9is/yy0/k1hky5/+Yvn42f1vuhvqvdSWPxx/fqlb35521nvQA/+jefBID0ZTXll527If3DgSF7Q2pDVXMHfYa6k/XHOqFKUP9W9GOTgYB0vk/1x4NObHQ4MPTvnf7uDOnCoL+6f/CkSPdP6q+vP13/0/3jC/Kjf/6MAemrupK7+TA6bD6N63xtwn6bGOqf1L/6PMisID+2jsU11ESNpuLbS8aGBidHzeShKD+mJEqrWPWdyeXVT6PDgaHNb5p+R1PwT+Z+jA0NTo4AnbYl+TF1TNhI60Q2f1Bto9geNvl00WdRCdKnSvJj6pgwzOveVd2nGh36Dc2p831AOvHC/GywIX13uiZvchgwNAwMbZ6+qDEs0q9L8mPOCB41vjR9ebUxfanRod9Qv2txavsdTfaDfkdnqOvTlOHHddOxoeZp8E91X3V06DfkOqd/tT/52D4nNdl3J/uGTsLntLX8OEsSR01eH7/9HD5cXyv4mQfo8WSqb24PBcu1/7ldFCzTu/otAQEREBABAREQEAEBERAQAQEREBABAREQEAEB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" /><!-- --></p>
<h3 id="comparing-the-computation-time">Comparing the computation
time</h3>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a>  <span class="at">Rcpp =</span> <span class="fu">gibbs_sampler_rcpp</span>(n, a, b, num_iter),</span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">gibbs_sampler_r</span>(n, a, b, num_iter),</span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">10</span></span>
<span id="cb144-7"><a href="#cb144-7" tabindex="-1"></a>)</span>
<span id="cb144-8"><a href="#cb144-8" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq   median      uq
## 1 Rcpp  2.3158  2.38045  2.4326
## 2    R 21.2954 21.87780 23.6119</code></pre>
<h3 id="comments">Comments</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>QQ图大体呈直线, 证明二者生成的随机序列同分布</p></li>
<li><p>Rcpp计算时间显著小于R.</p></li>
</ol>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
